<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  
  <meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link rel="dns-prefetch" href="http://xieyuxuan.cc">
  <title>谢雨轩的博客 | Vera Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="前端技术分享,前端个人博客">
<meta property="og:type" content="website">
<meta property="og:title" content="谢雨轩的博客 | Vera Blog">
<meta property="og:url" content="http://xieyuxuan.cc/index.html">
<meta property="og:site_name" content="谢雨轩的博客 | Vera Blog">
<meta property="og:description" content="前端技术分享,前端个人博客">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="谢雨轩的博客 | Vera Blog">
<meta name="twitter:description" content="前端技术分享,前端个人博客">
  
    <link rel="alternative" href="/atom.xml" title="谢雨轩的博客 | Vera Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/images/favicon.png">
  
  <link rel="stylesheet" href="/main.css">
  



  <!-- Piwik -->
  <script type="text/javascript">
    var _paq = _paq || [];
    // tracker methods like "setCustomDimension" should be called before "trackPageView"
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
      var u="//piwik.mritd.me/";
      _paq.push(['setTrackerUrl', u+'piwik.php']);
      _paq.push(['setSiteId', '3']);
      var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
      g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
    })();
  </script>
  <!-- End Piwik Code -->
</head>
</html>
<body>
  <div id="container">
    <div class="left-col">
      <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img src="/images/userimg.jpg" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">谢雨轩</a></h1>
		</hgroup>

		
		<p class="header-subtitle">Web前端技术宅升级打倒小怪兽</p>
		

		<nav class="header-menu">
			<ul>
			
				<li><a href="/">主页</a></li>
	        
				<li><a href="/types/webpack.html">webpack教程</a></li>
	        
				<li><a href="/types/origincode.html">源码剖析</a></li>
	        
				<li><a href="/types/web.html">移动端直通车</a></li>
	        
				<li><a href="/types/script.html">神奇JS</a></li>
	        
			</ul>
		</nav>
		<nav class="header-smart-menu">
	        
    		
    			
    			<a class="js-smart-menu" data-idx="0" href="javascript:void(0)">所有文章</a>
    			
    			
            
    			
    			<a class="js-smart-menu" data-idx="1" href="javascript:void(0)">标签</a>
    			
    			
            
    			
    			<a class="js-smart-menu" data-idx="2" href="javascript:void(0)">我的项目</a>
    			
    			
            
    			
    			<a class="js-smart-menu" data-idx="3" href="javascript:void(0)">关于我</a>
    			
    			
            
		</nav>
		<nav class="header-nav">
			<div class="social">
				
					<a class="github" target="_blank" href="https://github.com/Vera0707/huanhuashuixie" title="github">github</a>
		        
					<a class="mail" target="_blank" href="/lishuxia@gozap.com" title="mail">mail</a>
		        
			</div>
		</nav>
	</header>		
</div>

    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"><i class="icon-list"></i></div>
  		<h1 class="header-author js-mobile-header hide">谢雨轩</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				
					<img src="/images/userimg.jpg" class="js-avatar">
				
			</div>
			<hgroup>
			  <h1 class="header-author">谢雨轩</h1>
			</hgroup>
			
			<p class="header-subtitle">Web前端技术宅升级打倒小怪兽</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/types/webpack.html">webpack教程</a></li>
		        
					<li><a href="/types/origincode.html">源码剖析</a></li>
		        
					<li><a href="/types/web.html">移动端直通车</a></li>
		        
					<li><a href="/types/script.html">神奇JS</a></li>
		        
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/Vera0707/huanhuashuixie" title="github">github</a>
			        
						<a class="mail" target="_blank" href="/lishuxia@gozap.com" title="mail">mail</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>

      <canvas id="body-wrap"> </canvas>
      <div class="body-wrap">
          
  
    <article id="post-wbpackDepthExplanation4" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/09/04/wbpackDepthExplanation4/">从0基础到大牛-webpack深入浅出超强完整版(四)</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><abbr style="display:block;margin-top: -50px;font-size: 12px;color:#999;text-align: center;border-bottom: 1px dotted #999;">你可能只需要这一个教程</abbr></p>
<h2 id="webpack-Plugin"><a href="#webpack-Plugin" class="headerlink" title="webpack - Plugin"></a>webpack - Plugin</h2><p>&emsp;&emsp;loader和plugin都是webpack重要的组成部分，loader主要用于文件内的处理，而plugin主要用于文件间的处理，有时他们需要共同协作<br>&emsp;&emsp;plugin的执行顺序与书写顺序无关，它通常是一个构造函数，挂载到webpack不同的生命周期中，等待执行</p>
<ul>
<li>html-webpack-plugin</li>
</ul>
<p>&emsp;&emsp;html-webpack-plugin是我们最长的Plugin之一，它会帮我们管理html,<br>&emsp;&emsp;下载插件<code>npm install --save--dev html-webpack-plugin</code>,配置如下<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">'html-webpack-plugin'</span>);</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    entry: &#123;&#125;,</span><br><span class="line">    output: &#123;&#125;,</span><br><span class="line">    mode: <span class="string">"development"</span>,</span><br><span class="line">    <span class="built_in">module</span>:&#123;&#125;,</span><br><span class="line">    plugins: [</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// new HtmlWebpackPlugin()</span></span><br><span class="line">        <span class="comment">// 默认在output文件下生成一个标题为Webpack App的html文件，并引入entry内的所有文件</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">            template : <span class="string">"./src/index.html"</span> </span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="comment">// 指定html模板文件 会自动复制当前文件到output文件下，并引入entry内的所有口文件</span></span><br><span class="line">    ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<ul>
<li>clean-webpack-plugin</li>
</ul>
<p>&emsp;&emsp;想要每次新打包前清除output文件，以防止废弃文件占用内存空间，我们可以使用clean-webpack-plugin<br>&emsp;&emsp;下载插件<code>npm install --save--dev clean-webpack-plugin</code>,配置如下<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; CleanWebpackPlugin &#125; = <span class="built_in">require</span>(<span class="string">'clean-webpack-plugin'</span>);</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    plugins: [</span><br><span class="line">        <span class="keyword">new</span> CleanWebpackPlugin(),</span><br><span class="line">    ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<ul>
<li>指定服务器地址</li>
</ul>
<p>&emsp;&emsp;如有需要指定打包的服务器地址，可配置如下<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    output: &#123;</span><br><span class="line">        filename: <span class="string">'[name].js'</span>,</span><br><span class="line">        path: path.resolve(__dirname,<span class="string">'dist'</span>),</span><br><span class="line">        publicPath: <span class="string">"http://xieyuxuan.cc"</span>     <span class="comment">// 服务器地址</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;打包后html引入的入口文件，都将会是publicPath的值+文件名</p>
<ul>
<li>错误调试 - sourceMap</li>
</ul>
<p>&emsp;&emsp;早期webpack打包后如有代码错误无法直接定位到源码，仅显示打包后的文件错误位置，这给开发调试造成了很大障碍<br>&emsp;&emsp;sourceMap是一个映射关系表，能够将我们所有的源文件的映射到打包后的文件上。<br>&emsp;&emsp;通过配置<a href="https://webpack.js.org/configuration/devtool/" target="_blank" rel="noopener">devtool</a>，满足不同场景的调试需求<br><code>js
    module.exports = {
        devtool: &#39;none&#39;   // 默认值是none
                          // source-map  会在output文件下生成一个 [output.filename].map的 映射文件
                          // inlne-source-map 将映射文件打入[output.filename] 内最底部
                          // cheap-module-source-map 生成环境中最常使用 生成[output.filename].map的 映射文件
                          // cheap-module-eval-source-map 开发环境中最常使用
                          // ...
    };</code></p>
<ul>
<li>webpack-dev-server - 本地服务器</li>
</ul>
<p>&emsp;&emsp;webpack –watch命令可以实现文件更新检测，但这种方式无法满足我们的开发需要<br>&emsp;&emsp;webpack-dev-server主要用于本地开发，满足我们的常规开发需求，大大提升我们工作效率<br>&emsp;&emsp;它为我们开启一个本地服务器，可以实现热更新、跨域(服务器端没有跨域)、重定向等功能<br>&emsp;&emsp;下载webpack-dev-server依赖<code>npm install --save--dev webpack-dev-server</code>,并在webpack.config.js中配置devServer属性<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    entry: &#123;&#125;,</span><br><span class="line">    output: &#123;&#125;,</span><br><span class="line">    mode: <span class="string">"development"</span>,</span><br><span class="line">    <span class="built_in">module</span>:&#123;&#125;,</span><br><span class="line">    devServer:&#123;</span><br><span class="line">        contentBase: <span class="string">'./dist'</span>,   <span class="comment">// 服务器根文件地址</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;在package.json中添加脚本，实现npm run dev开启本地服务<br><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"scripts"</span>: &#123;</span><br><span class="line">    <span class="attr">"test"</span>: <span class="string">"echo \"Error: no test specified\" &amp;&amp; exit 1"</span>,</span><br><span class="line">    <span class="attr">"dev"</span>: <span class="string">"webpack-dev-server"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;终端执行npm run dev后，webpack会告诉我们webpack-dev-server为我们开启了一个地址为<a href="http://localhost:8080的服务" target="_blank" rel="noopener">http://localhost:8080的服务</a><br>&emsp;&emsp;此时观察dist文件，该目录下文件清空，但页面显示正常，文件更改后会自动刷新页面并重新执行<br>&emsp;&emsp;dist下的文件不再存放在磁盘中，而是被放置在内存中</p>
<p>&emsp;&emsp;webpack-dev-server其它常用配置如下<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    devServer:&#123;</span><br><span class="line">        contentBase: <span class="string">'./dist'</span>,   <span class="comment">// 服务器根文件地址</span></span><br><span class="line">        open: <span class="literal">true</span>,              <span class="comment">// 自动打开页面</span></span><br><span class="line">        host: <span class="string">'localhost'</span>,                <span class="comment">// 指定服务器地址 默认 localhost</span></span><br><span class="line">        port: <span class="number">8080</span>               <span class="comment">// 指定端口号 默认8080</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;实现HMR(热模块更新)<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    devServer:&#123;</span><br><span class="line">        contentBase: <span class="string">'./dist'</span>,</span><br><span class="line">        open: <span class="literal">true</span>,     </span><br><span class="line">        hot: <span class="literal">true</span>           <span class="comment">// 开启热模块更新</span></span><br><span class="line">    &#125;,</span><br><span class="line">    plugins: [</span><br><span class="line">        <span class="keyword">new</span> webpack.HotModuleReplacementPlugin()  <span class="comment">// 配置热更新</span></span><br><span class="line">    ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<ul>
<li>TreeShaking</li>
</ul>
<p>&emsp;&emsp;有时我们定义了N个方法，但仅有部分方法被调用,不想让所有的方法都被打入，这时候我们就需要shaking一下<br>&emsp;&emsp;将未被使用的 exported member 标记为 unused 同时在将其 re-export 的模块中不再 export<br>&emsp;&emsp;这里必须使用ESmodule的引入方式<br>&emsp;&emsp;webpack.config.js新增配置如下<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    entry: &#123;&#125;,</span><br><span class="line">    output: &#123;&#125;,</span><br><span class="line">    mode: <span class="string">"development"</span>,</span><br><span class="line">    optimization: &#123;</span><br><span class="line">        usedExports: <span class="literal">true</span>,    <span class="comment">// 开去tree shaking</span></span><br><span class="line">    &#125;,   </span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;同时需要在package中新增配置，取消副作用<br><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"name"</span>: <span class="string">"webpack-demo"</span>,</span><br><span class="line">  <span class="attr">"version"</span>: <span class="string">"1.0.0"</span>,</span><br><span class="line">  <span class="attr">"slideEffects"</span>: <span class="literal">false</span>   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;虽然webpack设置了tree shaking，但是比如包中有一些配置，设定，日志等产生的副作用，会使得包文件依然会被打入<br>&emsp;&emsp;如果你不想，可以设置slideEffects为false，或者通过数组指定<br>&emsp;&emsp;我们在设置副作用时应当明确,这个包没有副作用或者不需要它们的副作用<br>&emsp;&emsp;webpack会在线上shaking掉，我们的配置才会有效，而开发环境我们可以看到它的分析结果</p>
<ul>
<li>开发模式 和 生产模式</li>
</ul>
<p>&emsp;&emsp;开发模式 development 本地编写代码<br>&emsp;&emsp;生产模式 production 用于打包完成后交给线上服务<br>&emsp;&emsp;区分两种模式，实现不同环境的打包，现我们新建webpack.dev.js做开发配置，并将所有开发环境的配置保留,可参考如下<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">'html-webpack-plugin'</span>);</span><br><span class="line"><span class="keyword">const</span> &#123; CleanWebpackPlugin &#125; = <span class="built_in">require</span>(<span class="string">'clean-webpack-plugin'</span>);</span><br><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    entry: &#123; <span class="string">'app'</span> : <span class="string">'./src/app.js'</span> &#125;,</span><br><span class="line">    output: &#123;</span><br><span class="line">        filename: <span class="string">'[name].js'</span>,</span><br><span class="line">        path: path.resolve(__dirname,<span class="string">'../dist'</span>),</span><br><span class="line">    &#125;,</span><br><span class="line">    devtool: <span class="string">'cheap-module-eval-source-map'</span>,</span><br><span class="line">    mode: <span class="string">"development"</span>,</span><br><span class="line">    devServer:&#123;</span><br><span class="line">        contentBase: <span class="string">'./dist'</span>,</span><br><span class="line">        hot: <span class="literal">true</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    optimization:&#123;</span><br><span class="line">        usedExports: <span class="literal">true</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="built_in">module</span>:&#123;&#125;,   <span class="comment">//  此处省略</span></span><br><span class="line">    plugins: [</span><br><span class="line">        <span class="keyword">new</span> HtmlWebpackPlugin(</span><br><span class="line">            &#123;<span class="attr">template</span> : <span class="string">"./src/index.html"</span>&#125;</span><br><span class="line">        ),</span><br><span class="line">        <span class="keyword">new</span> CleanWebpackPlugin(),</span><br><span class="line">        <span class="keyword">new</span> webpack.HotModuleReplacementPlugin()</span><br><span class="line">    ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;新建webpack.prod.js，做线上配置，并将所有线上环境的配置保留，可参考如下<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">'html-webpack-plugin'</span>);</span><br><span class="line"><span class="keyword">const</span> &#123; CleanWebpackPlugin &#125; = <span class="built_in">require</span>(<span class="string">'clean-webpack-plugin'</span>);</span><br><span class="line">   </span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    entry: &#123;<span class="string">'main'</span> : <span class="string">'./src/main.js'</span>&#125;,</span><br><span class="line">    output: &#123;</span><br><span class="line">        filename: <span class="string">'[name].js'</span>,</span><br><span class="line">        path: path.resolve(__dirname,<span class="string">'../dist'</span>),</span><br><span class="line">    &#125;,</span><br><span class="line">    devtool: <span class="string">'cheap-eval-source-map'</span>,</span><br><span class="line">    mode: <span class="string">"production"</span>,</span><br><span class="line">    optimization:&#123;</span><br><span class="line">        usedExports: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="built_in">module</span>:&#123;&#125;,                     <span class="comment">//  此处省略</span></span><br><span class="line">    plugins: [</span><br><span class="line">        <span class="keyword">new</span> HtmlWebpackPlugin(</span><br><span class="line">            &#123;<span class="attr">template</span> : <span class="string">"./src/index.html"</span>&#125;</span><br><span class="line">        ),</span><br><span class="line">        <span class="keyword">new</span> CleanWebpackPlugin(),</span><br><span class="line">    ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;将webpack配置文件都放入根目录下的config文件夹内<br>&emsp;&emsp;配置package.json，通过不同的命令执行不同的打包规则<br><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">   <span class="attr">"name"</span>: <span class="string">"webpack-demo"</span>,</span><br><span class="line">   <span class="attr">"version"</span>: <span class="string">"1.0.0"</span>,</span><br><span class="line">   <span class="attr">"scripts"</span>: &#123;</span><br><span class="line">      <span class="attr">"dev"</span>: <span class="string">"webpack-dev-server --config config/webpack.dev.js"</span>,</span><br><span class="line">      <span class="attr">"build"</span>: <span class="string">"webpack --config config/webpack.prod.js"</span></span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;通过命令<code>npm run dev</code>与命令<code>npm run build</code>我们实现了不同环境下的打包<br>&emsp;&emsp;虽然我们已经可以区分两种环境了,但是很明显配置文件中包含大量共同部分，现在我们新建webpack.common.js文件，提取公共部分</p>

      
    </div>
      <div id="remark"></div>
    <div class="article-info article-info-index">
      
      <a href="/2019/09/04/wbpackDepthExplanation4/" class="archive-article-date">
  	<time datetime="2019-09-04T12:14:37.000Z" itemprop="datePublished"><i class="icon-clock"></i>2019-09-04</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/webpack/">webpack</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/webpack-4-0/">webpack 4.0</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/webpack教程/">webpack教程</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/前端/">前端</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<i class="icon-price-tags"></i>
	<a class="article-category-link" href="/categories/个人博客/">个人博客</a>
	</div>


      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-wbpackDepthExplanation3" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/09/03/wbpackDepthExplanation3/">从0基础到大牛-webpack深入浅出超强完整版(三)</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><abbr style="display:block;margin-top: -50px;font-size: 12px;color:#999;text-align: center;border-bottom: 1px dotted #999;">你可能只需要这一个教程</abbr></p>
<h2 id="webpack-万物皆可打包"><a href="#webpack-万物皆可打包" class="headerlink" title="webpack - 万物皆可打包"></a>webpack - 万物皆可打包</h2><ul>
<li>打包CSS</li>
</ul>
<p>&emsp;&emsp;通过import或require引入样式文件，webpack无法直接打包，需引入<a href="https://webpack.js.org/loaders/css-loader/" target="_blank" rel="noopener">css-loader</a>将其转化<br>&emsp;&emsp;下载依赖css-loader与style-loader<code>npm install --save-dev css-loader style-loader</code>，并新增配置如下<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="built_in">module</span>:&#123;</span><br><span class="line">      rules: [</span><br><span class="line">          &#123;</span><br><span class="line">              test: <span class="regexp">/\.css$/</span>,</span><br><span class="line">              loader: [<span class="string">'style-loader'</span>,<span class="string">'css-loader'</span>],</span><br><span class="line">              exclude: <span class="regexp">/node_modules/</span></span><br><span class="line">          &#125;</span><br><span class="line">      ]</span><br><span class="line">  &#125;  </span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;loader的执行顺序是从后向前，即先执行css-loader，转化后交给style-loader，将其挂载到html文件内<br>&emsp;&emsp;css-loader负责转化css,而style-loader将转化后的css，包裹在style标签内，并将其插入到html文件的header中<br>&emsp;&emsp;此处应注意包引入的顺序与被置入的内联样式顺序有关，重复并不会转化多次<br>&emsp;&emsp;style-loader是以文件为单位，将其包裹为一个内部样式<br>&emsp;&emsp;css实际打包进了js文件，并未分离出来，后面将讲解css的分离配置</p>
<ul>
<li>打包CSS预编译语言（scss/less/stylus）</li>
</ul>
<p>&emsp;&emsp;css预编译语言同样无法直接编译,需要使用相应的loader,我们以sass为例<br>&emsp;&emsp;下载<a href="https://webpack.js.org/loaders/sass-loader/" target="_blank" rel="noopener">sass-loader</a>,这里我们跟着官方文档第一个来配置<br>&emsp;&emsp;有时官方文档也会出现更新不及时的问题,另sass-loader依赖node-sass,它在底层是用C语言编写，可能会在服务器端出现依赖包问题<br>&emsp;&emsp;下载依赖<code>npm install sass-loader node-sass webpack --save-dev</code>，并配置如下<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="built_in">module</span>:&#123;</span><br><span class="line">      rules: [</span><br><span class="line">          &#123;</span><br><span class="line">              test: <span class="regexp">/\.s[ac]ss$/i</span>,</span><br><span class="line">              loader: [<span class="string">'style-loader'</span>,<span class="string">'css-loader'</span>,<span class="string">'scss-loader'</span>],</span><br><span class="line">              exclude: <span class="regexp">/node_modules/</span></span><br><span class="line">          &#125;</span><br><span class="line">      ]</span><br><span class="line">  &#125;  </span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;与css相比，我们需要先使用scss-loader将sass语言转为css语言</p>
<ul>
<li>添加CSS3前缀</li>
</ul>
<p>&emsp;&emsp;浏览器一日不统一，我们就需要一日跟兼容性抗争到底。每次写样式我们都要加一堆的兼容前缀么？自动添加兼容代码，摆脱兼容烦恼<br>&emsp;&emsp;下载依赖<code>npm install --save--dev postcss-loader autoprefixer</code><br>&emsp;&emsp;需要在css的loader中修改,我们以sass加配置<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">      <span class="built_in">module</span>:&#123;</span><br><span class="line">          rules: [</span><br><span class="line">              &#123;</span><br><span class="line">                  test: <span class="regexp">/\.s[ac]ss$/i</span>,</span><br><span class="line">                  loader: [<span class="string">'style-loader'</span>,<span class="string">'css-loader'</span>,<span class="string">'sass-loader'</span>,<span class="string">'postcss-loader'</span>],</span><br><span class="line">                  exclude: <span class="regexp">/node_modules/</span></span><br><span class="line">              &#125;</span><br><span class="line">          ]</span><br><span class="line">      &#125;  </span><br><span class="line">    &#125;;</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;同时我们需要在根目录下新建postcss的配置文件postcss.config.js,配置如下<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">modules.exports = &#123;</span><br><span class="line">    plugins: [ <span class="built_in">require</span>(<span class="string">"autoprefixer"</span>) ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;此处也可以直接配置在webpack中，如下<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">      <span class="built_in">module</span>:&#123;</span><br><span class="line">          rules: [</span><br><span class="line">              &#123;</span><br><span class="line">                  test: <span class="regexp">/\.s[ac]ss$/i</span>,</span><br><span class="line">                  loader: [<span class="string">'style-loader'</span>,<span class="string">'css-loader'</span>,<span class="string">'sass-loader'</span>,&#123;</span><br><span class="line">                      loader: <span class="string">'postcss-loader'</span>,</span><br><span class="line">                      options:&#123;</span><br><span class="line">                          plugins: [<span class="built_in">require</span>(<span class="string">'autoprefixer'</span>)]</span><br><span class="line">                      &#125;</span><br><span class="line">                  &#125;],</span><br><span class="line">                  exclude: <span class="regexp">/node_modules/</span></span><br><span class="line">              &#125;</span><br><span class="line">          ]</span><br><span class="line">      &#125;  </span><br><span class="line">    &#125;;</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;post-loader会自动加载postcss.config.js下的配置,将文件内配置的插件加载进去<br>&emsp;&emsp;这时再打包出来的css，将会自动为我们加入兼容前缀</p>
<ul>
<li>css模块化打包</li>
</ul>
<p>&emsp;&emsp;当前引入与打包生成的css样式，是全局样式，如何做到样式隔离呢<br>&emsp;&emsp;像vue样式的scoped，如何样式隔离只针对当前工作区呢<br>&emsp;&emsp;css模块化配置如下（scss/less/stylus等相同）<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">      <span class="built_in">module</span>:&#123;</span><br><span class="line">          rules: [</span><br><span class="line">              &#123;</span><br><span class="line">                  test: <span class="regexp">/\.css$/</span>,</span><br><span class="line">                  loader: [<span class="string">'style-loader'</span>,&#123;</span><br><span class="line">                      loader: <span class="string">'css-loader'</span>,</span><br><span class="line">                          options: &#123;</span><br><span class="line">                               modules: <span class="literal">true</span>   <span class="comment">// true/local 开启模块化机制 默认global</span></span><br><span class="line">                          &#125;</span><br><span class="line">                       &#125;],</span><br><span class="line">                  exclude: <span class="regexp">/node_modules/</span></span><br><span class="line">              &#125;</span><br><span class="line">          ]</span><br><span class="line">      &#125;  </span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;之前我们引入样式的方式如下<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">"./app.css"</span>;</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;重新打包后我们发现，app.css中标签样式可以显示,而类选择器、id选择器等样式没有生效<br>&emsp;&emsp;我们查看一下打包后生成的样式会发现样式并没有丢失，但除标签名外,其他选择器名都帮我们改为了无意义的字符串<br>&emsp;&emsp;也就是说，如果我们想用这些样式，就要知道我们写的类名对应生成的字符串是什么，那么如何获取这些名称呢<br>&emsp;&emsp;modules为我们抛出了一个对象，key为我们定义的选择器名，value对应生成的字符串<br>&emsp;&emsp;我们需要这样引入：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 个人猜测 模块化是根据原有选择器名进行编码处理 再通过export default &#123; 选择器名1: 编码选择器名1,选择器名2: 编码选择器名2,...  &#125;</span></span><br><span class="line"><span class="keyword">import</span> CSS <span class="keyword">from</span><span class="string">"./app.css"</span>; </span><br><span class="line"></span><br><span class="line"><span class="comment">// 假如我们在app.css有一个样式 .avatar&#123; ... &#125;  此时我们只需要获取CSS.avatar 并将其绑定到对应DOM上，即可生效</span></span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;默认hash编码，我们还可以指定编码方式</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">      <span class="built_in">module</span>:&#123;</span><br><span class="line">          rules: [</span><br><span class="line">              &#123;</span><br><span class="line">                  test: <span class="regexp">/\.css$/</span>,</span><br><span class="line">                  loader: [<span class="string">'style-loader'</span>,&#123;</span><br><span class="line">                      loader: <span class="string">'css-loader'</span>,</span><br><span class="line">                          options: &#123;</span><br><span class="line">                              modules: &#123;</span><br><span class="line">                                   localIdentName: <span class="string">'[path][name]__[local]--[hash:base64:5]'</span>,</span><br><span class="line">                              &#125;,</span><br><span class="line">                          &#125;</span><br><span class="line">                       &#125;],</span><br><span class="line">                  exclude: <span class="regexp">/node_modules/</span></span><br><span class="line">              &#125;</span><br><span class="line">          ]</span><br><span class="line">      &#125;  </span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<ul>
<li>字体打包</li>
</ul>
<p>&emsp;&emsp;当我们使用外部字体库时，很显然直接引用，我们需要对字体进行打包处理<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">      <span class="built_in">module</span>:&#123;</span><br><span class="line">          rules: [</span><br><span class="line">              &#123;</span><br><span class="line">                  test: <span class="regexp">/\.(woff|woff2|svg|eot|ttf)/</span>,   <span class="comment">// 常用字体库</span></span><br><span class="line">                  loader: [&#123;</span><br><span class="line">                      loader: <span class="string">'file-loader'</span>,            <span class="comment">// 还记得我们的图片打包么</span></span><br><span class="line">                          options: &#123;                    <span class="comment">// 若不配置，默认打包只output文件下，并修改文件名为编码后的字符串</span></span><br><span class="line">                             outputPath: <span class="string">"font/"</span>,          <span class="comment">// 输出的文件路径</span></span><br><span class="line">                             name: <span class="string">'[name].[ext]'</span>          <span class="comment">// 输出的文件名 ext是文件后缀名称</span></span><br><span class="line">                          &#125;</span><br><span class="line">                       &#125;],</span><br><span class="line">                  exclude: <span class="regexp">/node_modules/</span></span><br><span class="line">              &#125;</span><br><span class="line">          ]</span><br><span class="line">      &#125;  </span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>

      
    </div>
      <div id="remark"></div>
    <div class="article-info article-info-index">
      
      <a href="/2019/09/03/wbpackDepthExplanation3/" class="archive-article-date">
  	<time datetime="2019-09-03T07:18:14.000Z" itemprop="datePublished"><i class="icon-clock"></i>2019-09-03</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/webpack/">webpack</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/webpack-4-0/">webpack 4.0</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/webpack教程/">webpack教程</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/前端/">前端</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<i class="icon-price-tags"></i>
	<a class="article-category-link" href="/categories/个人博客/">个人博客</a>
	</div>


      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-jquerySourceCode1" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/09/02/jquerySourceCode1/">上古利器jQuery源码剖析(一)</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><abbr style="display:block;margin-top: -50px;font-size: 12px;color:#999;text-align: center;border-bottom: 1px dotted #999;">上古利器 虽经沧海变革 宝剑尚锋</abbr></p>
<p>&emsp;随着数据驱动时代的到来，jQuery不可避免的跌下神坛，但应记得它曾何等辉煌<br>&emsp;我们学习jQuery，不是学习它的用法，而是学习它的架构，它的思想，来深刻理解JS<br>&emsp;优秀的jQuery并未落伍，像当下最火着的axios/fetch等都源自对ajax的吸纳，11年就出现的异步解决方法deferred，我们在ES6的Promise里看到了它的影子<br>&emsp;开拔</p>
<p>&emsp;$ 只是一个 jQuery的一个别名<br>&emsp;jQuery是一个构造函数,现在可以理解为就是一个最普通的构造函数<br>&emsp;但是我们在调用jQuery的时候,并没有使用new关键字呢.其实这里,jQuery帮我们做了一层语法糖的封装,即调用$()的时候,它自动帮我们创建了jQuery的实例对象<br>&emsp;即$() 就是new $()</p>
<p>&emsp;&emsp;<abbr style="display:block;color: brown;">* 起手式</abbr> </p>
<p>&emsp;首先我们创造一个自执行函数,传入this,通过root来接收<br>&emsp;在匿名函数里 我们创建一个叫jQuery的变量,jQuery变量拿到的是一个匿名函数的引用<br>&emsp;这个匿名函数,我们会把它当成构造函数<br>&emsp;因为我们是在全局环境下传入的this,所以这里的this指的就是window对象<br>&emsp;给环境变量root扩展一个叫做jQuery的属性,让它指向jQuery变量,同时再给root扩展一个叫做$的别名<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params">root</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> jQuery = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;   <span class="comment">// 构造函数</span></span><br><span class="line">    </span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">//root.jQuery = jQuery;</span></span><br><span class="line">    root.$ = root.jQuery = jQuery;</span><br><span class="line">&#125;)(<span class="keyword">this</span>);   <span class="comment">// 环境变量this 因为是全局环境 所以这里指的是window</span></span><br></pre></td></tr></table></figure></p>
<p>&emsp;这个时候我们输出$,得到的会是一个匿名函数,那源码是如何将其这个语法糖封装的?<br>&emsp;我们给jQuery的原型对象封装一个init的方法<br>&emsp;我们会把这个init对象当做一个构造函数<br>&emsp;我们如何把这个init方法当做一个构造函数呢<br>&emsp;在ES5中构造函数本身就是一个函数对象,也就是说,构造函数与我们普通创建的函数是完全一样的(在其他语言中绝非如此,JS中为了得以区分我们都会将构造函数首字母大写)<br>&emsp;一个普通函数,如果我们通过new去创建它的实例,那么我们就把它当做构造函数,并给他指明原型对象<br>&emsp;我们将init方法的原型对象指向为jQuery的原型对象<br>&emsp;init是jQuery.prototype的一个方法,init的原型对象又是jQuery.prototype,那么init拥有了jQuery.prototype的所有方法(包括它自己)<br>&emsp;我们将jQuery返回init的实例new jQuery.prototype.init()<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params">root</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> jQuery = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;  <span class="comment">// 别忘了 jQuery我们也是当做构造函数的</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> jQuery.prototype.init();  <span class="comment">// 返回构造函数init的实例对象</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    jQuery.prototype = &#123;</span><br><span class="line">        init: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;       <span class="comment">// init是一个匿名对象,在这里我们将它当做一个构造函数</span></span><br><span class="line">            <span class="built_in">console</span>.log(<span class="number">111</span>);   <span class="comment">// 测试代码</span></span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    jQuery.prototype.init.prototype = jQuery.prototype; <span class="comment">// init的原型对象指向为jQuery的原型原型对象</span></span><br><span class="line"></span><br><span class="line">    root.$ = root.jQuery = jQuery;</span><br><span class="line">&#125;)(<span class="keyword">this</span>);</span><br></pre></td></tr></table></figure></p>
<p>&emsp;设计的思路是这样的,我们有两个函数jQuery和init,$()就等同于实例化jQuery即new jQuery(),但们无法直接让jQuery函数返回new jQuery,这样会形成死循环,于是我们实例化了另一个构造函数init<br>&emsp;我们将init方法的原型也指向了jQuery的方法原型,实现了原型共享<br>&emsp;因此,jQuery.prototype原型对象里封装的所有属性和方法,jQuery与init都是可以调用的<br>&emsp;最反思维的地方就在于了,init是Query.prototype原型对象的一个方法,可以想想计算机的自举~<br>&emsp;此时我们再调用$(),将输入111</p>
<p>&emsp;<abbr style="display:block;color: brown;">* 工具函数</abbr> </p>
<p>&emsp;jQuery框架非常重要的一个函数-工具函数,它的作用是将jQuery所有的自身对象或者实例对象的属性和方法,全部都剥离开来,进行分类管理<br>&emsp;jQuery中一共有两个对象,一个是实例对象,一个是jQuery本身的对象<br>&emsp;起手式中我们实现了实例对象,而jQuery除了是一个构造函数,它也是一个函数对象,我们也有很多函数对象是挂载到jQuery本身上的,例如$.ajax/$.each等<br>&emsp;我们给jQuery添加一个静态属性fn,我们让fn等于jQuery的原型对象,这样我们在外部扩展时,至需要扩展jQuery.fn即可<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params">root</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> jQuery = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> jQuery.prototype.init();</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    jQuery.fn = jQuery.prototype = &#123;    <span class="comment">// jQuery的静态方法等于jQuery的原型对象,原型对象也是对象</span></span><br><span class="line">        init: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    jQuery.fn.init.prototype = jQuery.fn;   <span class="comment">// 替换</span></span><br><span class="line"></span><br><span class="line">    root.$ = root.jQuery = jQuery;</span><br><span class="line"></span><br><span class="line">&#125;)(<span class="keyword">this</span>);</span><br></pre></td></tr></table></figure></p>
<p>&emsp;外部扩展时,只需要$.fn.新方法名 = function(){} -&gt;插件编写的形式<br>&emsp;通过调用静态属性扩展到jQuery的实例对象上</p>
<p>&emsp;<abbr style="display:block;color: brown;">* extend</abbr> </p>
<p>&emsp;extend在jQuery函数内部是作为一个工具函数存在,用它来管理不同对象(jQuery本身以及它的原型对象)的扩展<br>&emsp;extend在外部可以给 ①任意对象扩展/浅拷贝/深拷贝 ②jQuery本身扩展 ③jQuery实例对象扩展<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params">root</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> jQuery = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> jQuery.prototype.init();</span><br><span class="line">    &#125;;</span><br><span class="line">    jQuery.fn = jQuery.prototype = &#123;</span><br><span class="line">        init: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// jQuery与 jQuery.prototype的原型都扩展了一个extend属性</span></span><br><span class="line">    jQuery.extend = jQuery.prototype.extend = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">// 方法调用时,我们有可能给任何对象/jQuery对象/jQuery原型对象进行扩展</span></span><br><span class="line">        <span class="comment">// 我们通过参数来进行区分</span></span><br><span class="line">        <span class="comment">// 参数1 是我们要扩展的对象 参数2 是我们要变量的对象</span></span><br><span class="line">        <span class="comment">// 分析 有1个参数 可能给jQuery对象/jQuery原型对象扩展 有2个及以上 给任意对象arguments[0]扩展</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> target = <span class="built_in">arguments</span>[<span class="number">0</span>] || &#123;&#125;;   <span class="comment">// 参数处理: 参数为空? 赋值对象不是引用类型?</span></span><br><span class="line">        <span class="keyword">var</span> length = <span class="built_in">arguments</span>.length;  <span class="comment">// 参数个数</span></span><br><span class="line">        <span class="keyword">var</span> i = <span class="number">1</span>;  <span class="comment">// 默认参数个数</span></span><br><span class="line">        <span class="keyword">var</span> option;</span><br><span class="line">        <span class="keyword">var</span> name;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">typeof</span> target !== <span class="string">"object"</span>)&#123;</span><br><span class="line">            target = &#123;&#125;;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 1个参数</span></span><br><span class="line">        <span class="keyword">if</span>(length == i)&#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2个及以上参数</span></span><br><span class="line">        <span class="keyword">for</span>(;i&lt;length;i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>((option = <span class="built_in">arguments</span>[i]) !== <span class="literal">null</span>)&#123;</span><br><span class="line">                <span class="keyword">for</span>(name <span class="keyword">in</span> option)&#123;</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    jQuery.fn.init.prototype = jQuery.fn;</span><br><span class="line">    root.$ = root.jQuery = jQuery;</span><br><span class="line"></span><br><span class="line">&#125;)(<span class="keyword">this</span>);</span><br></pre></td></tr></table></figure></p>
<p>&emsp;<br>&emsp;<br>&emsp;</p>

      
    </div>
      <div id="remark"></div>
    <div class="article-info article-info-index">
      
      <a href="/2019/09/02/jquerySourceCode1/" class="archive-article-date">
  	<time datetime="2019-09-02T05:17:50.000Z" itemprop="datePublished"><i class="icon-clock"></i>2019-09-02</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/jquery/">jquery</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/jquery源码/">jquery源码</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/jquery源码教程/">jquery源码教程</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/前端/">前端</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<i class="icon-price-tags"></i>
	<a class="article-category-link" href="/categories/个人博客/">个人博客</a>
	</div>


      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-wbpackDepthExplanation2" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/08/28/wbpackDepthExplanation2/">从0基础到大牛-webpack深入浅出超强完整版(二)</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><abbr style="display:block;margin-top: -50px;font-size: 12px;color:#999;text-align: center;border-bottom: 1px dotted #999;">你可能只需要这一个教程</abbr></p>
<h2 id="webpack小试牛刀-ES6-转-ES5"><a href="#webpack小试牛刀-ES6-转-ES5" class="headerlink" title="webpack小试牛刀 - ES6+ 转 ES5"></a>webpack小试牛刀 - ES6+ 转 ES5</h2><ul>
<li>全局垫片 polyfill</li>
</ul>
<p>&emsp;&emsp;使用babel,需要下载 babel-loader @babel/core @babel/preset-env<br>&emsp;&emsp;<a href="https://webpack.js.org/loaders/babel-loader/" target="_blank" rel="noopener">babel-loader</a> 下载 <code>npm install -D babel-loader @babel/core @babel/preset-env webpack</code><br>&emsp;&emsp;配置如下<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    <span class="built_in">module</span>: &#123;</span><br><span class="line">        rules: [    </span><br><span class="line">          &#123;</span><br><span class="line">              test: <span class="regexp">/\.js$/</span>,            <span class="comment">// 正则 匹配规则</span></span><br><span class="line">              exclude: <span class="regexp">/node_modules/</span>,  <span class="comment">// 依赖文件已做过处理，无需再处理，节省打包时间</span></span><br><span class="line">              loader: <span class="string">"babel-loader"</span>,   <span class="comment">// 使用的loader</span></span><br><span class="line">              option: &#123;                 <span class="comment">// 配置  option的配置应参照使用的loader配置列表</span></span><br><span class="line">                  presets: [<span class="string">"@babel/preset-env"</span> ] </span><br><span class="line">              &#125;</span><br><span class="line">          &#125;  </span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;打包生成的文件中，ES6语法将会转为ES5语法<br>&emsp;&emsp;但并不是所有的ES6都可以被转化，ES6中一些内置API和功能（Promise set Map）、Object.assign等无法转化<br>&emsp;&emsp;如果想要实现上述这些方法，我们需要使用垫片库（polyfill）<code>npm install -D @babel/polyfill</code><br>&emsp;&emsp;直接引入垫片库，会将所有方法都加载进来<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"@babel/polyfill"</span>;</span><br><span class="line"><span class="keyword">const</span> arr = [<span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">()</span>=&gt;</span>&#123;&#125;),<span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">()</span>=&gt;</span>&#123;&#125;)];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 此时  Object.assign Set Map等方法也会被打入,生成文件骤然变大</span></span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;如何实现按需加载呢？需要配置如下<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    <span class="built_in">module</span>: &#123;</span><br><span class="line">        rules: [</span><br><span class="line">            &#123;</span><br><span class="line">                rule: <span class="regexp">/\.js$/</span>,</span><br><span class="line">                exclude: <span class="regexp">/node_modules/</span>,</span><br><span class="line">                loader: <span class="string">"@babel-loader"</span>,</span><br><span class="line">                options: &#123;</span><br><span class="line">                    presets: [</span><br><span class="line">                        [<span class="string">"@babel/preset-env"</span>,&#123;</span><br><span class="line">                            <span class="string">"useBuiltIns"</span> : <span class="string">"usage"</span>, </span><br><span class="line">                            <span class="comment">// usage: 按需加载  页面无需引入"@babel/polyfill" </span></span><br><span class="line">                            <span class="comment">// entry: 按需加载  页面需手动引入 import "@babel/polyfill"</span></span><br><span class="line">                            <span class="comment">// 自测时发现 entry比usage打出的包更轻量</span></span><br><span class="line">                            </span><br><span class="line">                            <span class="string">"target"</span>: &#123;  <span class="comment">// 目标  针对浏览器版本打包</span></span><br><span class="line">                                ie: <span class="string">"9"</span></span><br><span class="line">                            &#125;    </span><br><span class="line">                        &#125;]</span><br><span class="line">                    ]</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<ul>
<li>babel的全局配置<br>&emsp;&emsp;webpack中options的配置可以全部放置到babel全局配置文件中，其作用和用法完全一致。首先我们先将webpack中babel的options清除<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">        <span class="built_in">module</span>: &#123;</span><br><span class="line">            rules: [</span><br><span class="line">                &#123;</span><br><span class="line">                    rule: <span class="regexp">/\.js$/</span>,</span><br><span class="line">                    exclude: <span class="regexp">/node_modules/</span>,</span><br><span class="line">                    loader: <span class="string">"@babel-loader"</span>,</span><br><span class="line">                &#125;</span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>&emsp;&emsp;根目录下新建babel配置文件: .babelrc 并配置如下(此处注意JSON写法)<br><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"presets"</span> : [[<span class="string">"@babel/preset-env"</span>,&#123;</span><br><span class="line">    <span class="attr">"useBuiltIns"</span>: <span class="string">"entry"</span>,</span><br><span class="line">    <span class="attr">"targets"</span>: &#123;</span><br><span class="line">      <span class="attr">"chrome"</span>: <span class="number">67</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;]]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<ul>
<li>局部垫片 transform-runtime</li>
</ul>
<p>&emsp;&emsp;polyfill是一个全局的垫片，会将方法全部扩展到原型上。如果是开发库或者框架，就需要使用局部垫片。<br>&emsp;&emsp;下载<a href="https://babeljs.io/docs/en/babel-plugin-transform-runtime" target="_blank" rel="noopener">transform-runtime</a> <code>npm install --save-dev @babel/plugin-transform-runtime</code> 和 <code>npm install --save @babel/runtime</code><br>&emsp;&emsp;.babelrc配置如下<br><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"presets"</span> : [<span class="string">"@babel/preset-env"</span>],</span><br><span class="line">  <span class="attr">"plugins"</span>: [</span><br><span class="line">    [</span><br><span class="line">      <span class="string">"@babel/plugin-transform-runtime"</span>,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">"absoluteRuntime"</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="attr">"corejs"</span>: <span class="literal">false</span>,  </span><br><span class="line">        <span class="attr">"helpers"</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">"regenerator"</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">"useESModules"</span>: <span class="literal">false</span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;transform-runtime默认按需加载，无需配置<br>&emsp;&emsp;corejs可取值false，2，3或{ version: 2 | 3, proposals: boolean }，默认为false详见文档</p>
<ul>
<li>更改文件打包地址</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">"path"</span>); <span class="comment">// node</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    output:&#123;</span><br><span class="line">        filename: <span class="string">'[name].js'</span>,</span><br><span class="line">        path: path.resolve(__dirname,<span class="string">'dist'</span>), <span class="comment">// __dirname为当前文件路径 dist可更改为要打包的路径名 默认dist</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>转换TS文件</li>
</ul>
<p>&emsp;&emsp;webpack支持<a href="https://webpack.js.org/guides/typescript/" target="_blank" rel="noopener">Typescript</a>打包，需先下载<code>npm install --save-dev typescript ts-loader</code><br>&emsp;&emsp;根目录下新建ts配置文件：tsconfig.json 并配置如下<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"compilerOptions"</span>: &#123;</span><br><span class="line">    <span class="string">"module"</span>: <span class="string">"es6"</span>,  <span class="comment">// 模块的引入方式 es6|commonjs</span></span><br><span class="line">    <span class="string">"target"</span>: <span class="string">"es5"</span>,  <span class="comment">// 目标语法</span></span><br><span class="line">    <span class="string">"allowJs"</span>: <span class="literal">true</span>   <span class="comment">// 是否允许JS语法</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"include"</span>: [        <span class="comment">// 包含文件列表</span></span><br><span class="line">      <span class="string">"./src/"</span>,</span><br><span class="line">      <span class="string">"./"</span></span><br><span class="line">  ],</span><br><span class="line">  <span class="string">"exclude"</span>: [        <span class="comment">//  不包含的文件</span></span><br><span class="line">      <span class="string">"node_modules"</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;并在webpack配置中新增loader<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">   <span class="built_in">module</span>: &#123;</span><br><span class="line">       rules: [</span><br><span class="line">           &#123;</span><br><span class="line">              test: <span class="regexp">/\.ts$/</span>,</span><br><span class="line">              loader: <span class="string">"ts-loader"</span>,</span><br><span class="line">              exclude: <span class="regexp">/node_modules/</span>,</span><br><span class="line">           &#125;</span><br><span class="line">       ]</span><br><span class="line">   &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;<a href="https://microsoft.github.io/TypeSearch/" target="_blank" rel="noopener">TypeSearch类型约束查找地址</a></p>
<ul>
<li>图片打包</li>
</ul>
<p>&emsp;&emsp;下载<a href="https://webpack.js.org/loaders/file-loader/" target="_blank" rel="noopener">file-loader</a> <code>npm install file-loader --save-dev</code><br>&emsp;&emsp;webpack中新增图片转换的loader<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line"> <span class="built_in">module</span> : &#123;</span><br><span class="line">     rules : [</span><br><span class="line">         &#123;</span><br><span class="line">            test: <span class="regexp">/\.(png|jpe?g|gif)/</span>,</span><br><span class="line">            use: &#123;</span><br><span class="line">               loader: <span class="string">"file-loader"</span>,</span><br><span class="line">               options:&#123;</span><br><span class="line">                   name: <span class="string">"[name]-[hash:5].[ext]"</span>,   <span class="comment">// name:图片名 ext:图片后缀名 hash:5 取Hash前5位值 默认文件名为hash:5</span></span><br><span class="line">                   outputPath: <span class="string">"images/"</span>            <span class="comment">// 输出文件夹(output.path)下 打包输出地址 </span></span><br><span class="line">               &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            exclude: <span class="regexp">/node_modules/</span></span><br><span class="line">         &#125;</span><br><span class="line">     ]</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;注：loader有多种引入写法<br>&emsp;&emsp;另一个插件<a href="https://webpack.js.org/loaders/url-loader/" target="_blank" rel="noopener">url-loader</a>包含file-loader,比file-loader更强大。<code>npm install -D url-loader</code><br>&emsp;&emsp;将上述配置file-loader改为url-loader,将不再生成image文件，会自动将图片转为base64位并注入js中。现在我们修改配置,限制转Base64大小<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line"> <span class="built_in">module</span> : &#123;</span><br><span class="line">     rules : [</span><br><span class="line">         &#123;</span><br><span class="line">            test: <span class="regexp">/\.(png|jpe?g|gif)/</span>,</span><br><span class="line">            use: &#123;</span><br><span class="line">               loader: <span class="string">"file-loader"</span>,</span><br><span class="line">               options:&#123;</span><br><span class="line">                   name: <span class="string">"[name]-[hash:5].[ext]"</span>,</span><br><span class="line">                   outputPath: <span class="string">"images/"</span>,  </span><br><span class="line">                   limit: <span class="number">1024</span> * <span class="number">1</span>            <span class="comment">//1024 = 1kb 低于1kb生成base64位，以减少http请求</span></span><br><span class="line">               &#125; </span><br><span class="line">            &#125;,   </span><br><span class="line">            exclude: <span class="regexp">/node_modules/</span></span><br><span class="line">         &#125;</span><br><span class="line">     ]</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>

      
    </div>
      <div id="remark"></div>
    <div class="article-info article-info-index">
      
      <a href="/2019/08/28/wbpackDepthExplanation2/" class="archive-article-date">
  	<time datetime="2019-08-28T10:14:43.000Z" itemprop="datePublished"><i class="icon-clock"></i>2019-08-28</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/webpack/">webpack</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/webpack-4-0/">webpack 4.0</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/webpack教程/">webpack教程</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/前端/">前端</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<i class="icon-price-tags"></i>
	<a class="article-category-link" href="/categories/个人博客/">个人博客</a>
	</div>


      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-wbpackDepthExplanation1" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/08/15/wbpackDepthExplanation1/">从0基础到大牛-webpack深入浅出超强完整版(一)</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><abbr style="display:block;margin-top: -50px;font-size: 12px;color:#999;text-align: center;border-bottom: 1px dotted #999;">你可能只需要这一个教程</abbr></p>
<h2 id="webpack介绍"><a href="#webpack介绍" class="headerlink" title="webpack介绍"></a>webpack介绍</h2><h6 id="1-webpack发展历程"><a href="#1-webpack发展历程" class="headerlink" title="1.webpack发展历程"></a>1.webpack发展历程</h6><p><abbr style="display:block;color: brown;">发布时间</abbr></p>
<ul>
<li>webpack &emsp; v1.x &emsp; 2014.02</li>
<li>webpack &emsp; v2.x &emsp; 2017.01</li>
<li>webpack &emsp; v3.x &emsp; 2017.06 </li>
<li>webpack &emsp; v4.0 &emsp; 2018.05  &emsp; 稳定版4.32.2</li>
<li>webpack &emsp; v5.x &emsp; 2019.xx  &emsp; 目前不是稳定的版本</li>
</ul>
<p><abbr style="display:block;color: brown;">模块化历程</abbr><br>&emsp;单页面应用(Vue React)都在用模块化</p>
<p><abbr style="font-size: 13px;color: burlywood;font-weight:bold;">命名空间</abbr> </p>
<p>&emsp;蛮荒时代的模块化<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;&#125;;</span><br><span class="line">obj.type = obj.type || &#123;&#125;;</span><br><span class="line">obj.type.method = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;;</span><br><span class="line">obj.type.add = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;;</span><br><span class="line">obj.type.sub = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;;</span><br><span class="line">   </span><br><span class="line">obj.addin = obj.addin || &#123;&#125;;</span><br><span class="line">obj.addin.remove = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;;</span><br><span class="line">obj.addin.append = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;;</span><br></pre></td></tr></table></figure></p>
<p>&emsp;AMD与CMD的中原逐鹿</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// AMD 异步加载 依赖前置 先加载后使用</span></span><br><span class="line"><span class="comment">// 需要库文件 - require.js</span></span><br><span class="line"><span class="comment">// 定义AMD模块  文件名amd</span></span><br><span class="line">define(<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>) </span>&#123;</span><br><span class="line"><span class="meta">    'use strict'</span>;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        add: <span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>) </span>&#123;</span><br><span class="line">          <span class="keyword">return</span> a + b;</span><br><span class="line">        &#125;,</span><br><span class="line">        sub: <span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>) </span>&#123;</span><br><span class="line">          <span class="keyword">return</span> a - b;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">   </span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 加载AMD模块</span></span><br><span class="line"><span class="built_in">require</span>([<span class="string">'moduleA'</span>,<span class="string">'moduleB'</span>,<span class="string">'amd'</span>],<span class="function"><span class="keyword">function</span>(<span class="params">a,b,amd</span>) </span>&#123;</span><br><span class="line">   <span class="built_in">console</span>.log(a);  <span class="comment">// a模块</span></span><br><span class="line">   <span class="built_in">console</span>.log(b);  <span class="comment">// b模块</span></span><br><span class="line">   </span><br><span class="line">   amd.add(<span class="number">1</span>,<span class="number">2</span>);   <span class="comment">// 调用amd</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// CMD 同步加载 依赖后置 使用时引入 </span></span><br><span class="line"><span class="comment">// 需要库文件 - sea.js</span></span><br><span class="line"><span class="comment">// 定义CMD模块  文件名cmd</span></span><br><span class="line">define(<span class="function"><span class="keyword">function</span>(<span class="params">require,exports,module</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> moduleA = <span class="built_in">require</span>(<span class="string">'moduleA'</span>);   <span class="comment">// 需要时引入</span></span><br><span class="line">    </span><br><span class="line">    exports = &#123;</span><br><span class="line">        add: <span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>) </span>&#123;</span><br><span class="line">          <span class="keyword">return</span> a+b;</span><br><span class="line">        &#125;,</span><br><span class="line">        sub: <span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>) </span>&#123;</span><br><span class="line">          <span class="keyword">return</span> a - b;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 加载CMD模块</span></span><br><span class="line">seajs.use([<span class="string">'cmd'</span>],<span class="function"><span class="keyword">function</span>(<span class="params">cmd</span>) </span>&#123;</span><br><span class="line">    cmd.add(<span class="number">1</span>,<span class="number">2</span>);</span><br><span class="line">    cmd.sub(<span class="number">2</span>,<span class="number">3</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>&emsp;commonJS -  Node.js主要践行者<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 一个文件就是一个模块 文件名common</span></span><br><span class="line"><span class="keyword">var</span> a = <span class="number">10</span>;</span><br><span class="line"><span class="keyword">var</span> b = <span class="number">20</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fun</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导出方式 一</span></span><br><span class="line">modules.export = &#123;</span><br><span class="line">    a : a,</span><br><span class="line">    b : b,</span><br><span class="line">    fun : b</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导出方式 二</span></span><br><span class="line"><span class="comment">// export.add = function()&#123;&#125;; ...</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 通过关键字require引入文件【相对路径/绝对路径引入】</span></span><br><span class="line"><span class="keyword">var</span> common = <span class="built_in">require</span>(<span class="string">'common'</span>);</span><br><span class="line"><span class="built_in">console</span>.log(common.a);  <span class="comment">// 10</span></span><br></pre></td></tr></table></figure></p>
<p>&emsp;官方科普最硬核 - ES Module(ES6的模块化)<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用方式 一</span></span><br><span class="line"><span class="comment">// 导出 文件名es1</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">var</span> a = <span class="number">10</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">var</span> add = <span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 引入</span></span><br><span class="line"><span class="keyword">import</span> &#123; a,add &#125; <span class="keyword">from</span> <span class="string">'es1'</span>;</span><br><span class="line">add(<span class="number">3</span>,<span class="number">5</span>);   <span class="comment">// 调用</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用方式 二</span></span><br><span class="line"> <span class="comment">// 导出 文件名es2</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">const</span> b = &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">20</span>;  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 引入</span></span><br><span class="line"><span class="keyword">import</span> b <span class="keyword">from</span> <span class="string">'es2'</span>;</span><br><span class="line"><span class="built_in">console</span>.log(b);</span><br></pre></td></tr></table></figure></p>
<p>&emsp;<abbr style="color: red;font-weight: bold;">*</abbr>CSS模块化</p>
<ul>
<li>OOCSS(面向对象)</li>
<li>AMCSS(属性模块)</li>
</ul>
<p><abbr style="display:block;color: brown;">webpack 4.32.2核心组成</abbr></p>
<ul>
<li>entry : 命令行中写入口，配置文件中 </li>
<li>output</li>
<li>module</li>
<li>plugins</li>
</ul>
<p>&emsp;准备工作<br>&emsp;&emsp;卸载旧的webpack版本 <code>npm uninstall webpack -g</code><br>&emsp;&emsp;下载最新的版本 <code>npm install webpack -g</code><br>&emsp;&emsp;检查当前webpack版本 <code>webpack --version</code><br>&emsp;&emsp;需要在本地文件内下载webpack,初始化package.json文件 <code>npm init -y</code><br>&emsp;&emsp;去下载 webpack 和 webpack-cli,3.x 的版本是不需要 webpack-cli,webpack 中集成了 webpack-cli, 4.X以后没有集成<br>&emsp;&emsp;webpack4.x 以下的使用 webpack app.js 是可以的，4.x以后因为增加了一个多入口命令打包，需要指定出口文: <code>webpack app.js -o bundle.js</code><br>&emsp;&emsp;如果不加 –mode development 参数，默认是生产环境，会自动压缩代码<br>&emsp;&emsp;当前可下载的webpack版本 <code>npm info webpack</code> webpack-5.x-bate(公测的版本)</p>
<p>&emsp;起手式<br>&emsp;&emsp;根目录下新建配置文件,默认配置文件为 webpack.config.js<br>&emsp;&emsp;你的第一个配置文件<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    <span class="comment">// 入口 相对文件地址</span></span><br><span class="line">    entry: <span class="string">'./app.js'</span>,</span><br><span class="line">    <span class="comment">// 出口</span></span><br><span class="line">    output: &#123;</span><br><span class="line">        filename: <span class="string">'bundle.js'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    mode: <span class="string">"development"</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;执行命令webpack后会生成 /dist/bundle.js 文件<br>&emsp;&emsp;使用自定义名称的配置文件my-webpack-setting.js打包，请执行 <code>webpack --config my-webpack-setting.js</code></p>
<ul>
<li><p>多入口打包</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">   entry: [<span class="string">'app.js'</span>,<span class="string">'app1.js'</span>,<span class="string">'app2.js'</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>自定义出口文件名打包</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    entry: &#123;</span><br><span class="line">        main: <span class="string">'./app1.js'</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    output: &#123;</span><br><span class="line">        filename: <span class="string">'[name].js'</span>,</span><br><span class="line">    &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>&emsp;&emsp;将生成 /dist/main.js 文件</p>
<ul>
<li>多入口多出口文件打包<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    entry: &#123;</span><br><span class="line">        main: <span class="string">'./app.js'</span>,</span><br><span class="line">        select: <span class="string">'./my_select.js'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    output: &#123;</span><br><span class="line">        filename: <span class="string">'[name].js'</span>,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>&emsp;&emsp;将在dist文件夹下生成main.js与select.js<br>&emsp;&emsp;注：多入口对应多出口,多入口对应单一出口配置时将会报错</p>
<ul>
<li>ES6 module 打包<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//  导出文件 es6.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> add = <span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导入文件 app.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; add &#125; <span class="keyword">from</span> <span class="string">'./es6.js'</span>;</span><br><span class="line"><span class="built_in">console</span>.log(add(<span class="number">4</span>,<span class="number">7</span>));   <span class="comment">// 11</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// webpack配置文件</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    entry: &#123;</span><br><span class="line">        app: <span class="string">'./app.js'</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    output: &#123;</span><br><span class="line">        filename: <span class="string">'[name].js'</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    mode: <span class="string">"development"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>&emsp;&emsp;结果生成 /dist/app.js 文件, 文件内包含 es6.js 与 app.js 代码</p>
<ul>
<li>CommonJS 打包<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导出 common.js</span></span><br><span class="line"><span class="built_in">module</span>.exports =  &#123;</span><br><span class="line">  add : <span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a + b;</span><br><span class="line">  &#125;,</span><br><span class="line">  sub: <span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;</span><br><span class="line">     <span class="keyword">return</span> a - b;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导入 app.js</span></span><br><span class="line"><span class="keyword">const</span>  method = reqiore(<span class="string">'./common,js'</span>);</span><br><span class="line"><span class="built_in">console</span>.log(method.add(<span class="number">4</span>,<span class="number">7</span>));   <span class="comment">// 11</span></span><br><span class="line"><span class="built_in">console</span>.log(method.sub(<span class="number">8</span>,<span class="number">3</span>));  <span class="comment">// 5</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// webpack配置文件 同上</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>&emsp;&emsp;结果生成 /dist/app.js 文件, 文件内包含 common.js 与 app.js 代码</p>
<ul>
<li>amd模块 打包</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导出 amd.js</span></span><br><span class="line">define(<span class="function"><span class="keyword">function</span>(<span class="params">require,factory</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">      mul: <span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> a * b;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导入</span></span><br><span class="line"><span class="built_in">require</span>([<span class="string">'./amd.js'</span>],<span class="function"><span class="keyword">function</span>(<span class="params">method</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(method.mul(<span class="number">10</span>,<span class="number">4</span>));   <span class="comment">// 40</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"> <span class="comment">// webpack配置文件 同上</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;dist文件夹下将生成 app.js与 0.js<br>&emsp;&emsp;0.js异步加载的内容(amd.js内容)</p>

      
    </div>
      <div id="remark"></div>
    <div class="article-info article-info-index">
      
      <a href="/2019/08/15/wbpackDepthExplanation1/" class="archive-article-date">
  	<time datetime="2019-08-15T07:20:27.000Z" itemprop="datePublished"><i class="icon-clock"></i>2019-08-15</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/webpack/">webpack</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/webpack-4-0/">webpack 4.0</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/webpack教程/">webpack教程</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/前端/">前端</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<i class="icon-price-tags"></i>
	<a class="article-category-link" href="/categories/个人博客/">个人博客</a>
	</div>


      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-javascriptPrototype" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/08/13/javascriptPrototype/">前端设计模式之依赖倒置原则(DIP)</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h6 id="前端原型的个人猜想"><a href="#前端原型的个人猜想" class="headerlink" title="前端原型的个人猜想"></a>前端原型的个人猜想</h6><p>&emsp;&emsp;相信每个学习javaScript的同僚,一定对一个说法非常熟悉『一切皆对象』.</p>
<p>&emsp;&emsp;这个说法很好的将我们从现实社会连接进了程序世界，同时也解释了程序界很多古怪无法理解的东西.</p>
<p>&emsp;&emsp;而事实真是这样么？在我写了这么久代码之后，我反而对javaScript最基本的东西产生了越发的迷茫和混乱.</p>
<p>&emsp;&emsp;像隐式转换、原型链的继承这种更是完全无法想通，当我看到null和undefined时鬼知道我的脑子会爆炸出什么,最后扭合到一起，变成一堆的问号…</p>
<p>&emsp;&emsp;现在我希望彻底能搞清祖师爷在创造javaScript是究竟是怎样的思路，这对我来说很难，但我知道当我搞清楚这个问题时，会有一个很大的飞跃，我不应该继续『不了解但不影响工作』在的舒适区混下去.</p>
<p>&emsp;&emsp;感谢jQuery的源码，让我有了共享原型的概念，不然我一定会强制要求原型链必须是个有唯一顶点的树状结构。</p>
<p>&emsp;&emsp;*请注意下面代码中，一定要将Object.prototype和Function.prototype当成是独立的一部分</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Object</span>.prototype.__proto__ == <span class="literal">null</span>   <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;这里我们知道了Object.prototype的原型链向上指向是null，注意我没有说它继承自null,因为null是个很特别的类型，我们都知道原型的本质是个对象，所以它应该继承自对象.<br>&emsp;&emsp;那这里怎么会是个null呢？我是猜想浏览器帮我们指向了null.<br>&emsp;&emsp;太好了，至少有一个封闭的点了！我们继续.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Object</span>.__proto__ == <span class="built_in">Function</span>.prototype  <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;大声尖叫，Object竟然继承自Function.prototype,『一切皆对象』并不是最后的真像！就好比我们好不容易发现了真菌细菌这些肉眼看不见的小东西，转眼我们又发现了分子原子，难道大世界无限的在嵌套我们不知道的小世界么？</p>
<p>&emsp;&emsp;好在程序世界的构成元素就是这几个，根本不存在宇宙这种无休无止的构成一说，但程序世界与现实世界还有一个最大的区别,叫做『自举』,这里我们可以简单理解为『我可以创造我自己』.</p>
<p>&emsp;&emsp;有了上面代码，就下面代码的成立.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Object</span> <span class="keyword">instanceof</span> <span class="built_in">Function</span> == <span class="literal">true</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;但是我们还知道</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Object</span> <span class="keyword">instanceof</span> <span class="built_in">Object</span> == <span class="literal">true</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;这里是『我创造了我自己』么?不是的，这里完全是多绕了一步</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Object</span>.__proto__ == <span class="built_in">Function</span>.prototype   <span class="comment">// true</span></span><br><span class="line"><span class="built_in">Function</span>.prototype.__proto__ == <span class="built_in">Object</span>.prototype    <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;目前还没有出现Object，我们又回到了Object.prototype，而Object.prototype.<strong>proto</strong>等于null这件事我们在第一步就已经证实过了.</p>
<p>&emsp;&emsp;问题出在哪呢？当然还是Object.prototype的继承问题！刚刚说过了Object.prototype很有可能是Object的实例,并保留了其继承关系，而浏览器对其赋值为null.</p>
<p>&emsp;&emsp;这完全出自我的个人想法，因为如果不是这样，这条原型链的解释则都不成立.</p>
<p>&emsp;&emsp;再看这个</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Function</span>.__proto__ == <span class="built_in">Function</span>.prototype  <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;Function继承自自己</p>
<pre><code>/* 这里非常明确了Object继承自Function.prototype */


/*我们知道了上面代码的关系 下面这句就理所当然了*/


/* 但我们还知道*/
</code></pre>
      
    </div>
      <div id="remark"></div>
    <div class="article-info article-info-index">
      
      <a href="/2019/08/13/javascriptPrototype/" class="archive-article-date">
  	<time datetime="2019-08-13T07:09:30.000Z" itemprop="datePublished"><i class="icon-clock"></i>2019-08-13</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/js原型/">js原型</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/前端/">前端</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<i class="icon-price-tags"></i>
	<a class="article-category-link" href="/categories/个人博客/">个人博客</a>
	</div>


      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-webpackStudyQuick" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/07/11/webpackStudyQuick/">webpack4.X 小白从0开始一步学到位</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><abbr style="display:block;margin-top: -50px;font-size: 12px;color:#999;text-align: center;border-bottom: 1px dotted #999;">来自三刷老肖的学习视频，依个人理解有增删</abbr></p>
<h2 id="webpack介绍"><a href="#webpack介绍" class="headerlink" title="webpack介绍"></a>webpack介绍</h2><h6 id="1-webpack是什么"><a href="#1-webpack是什么" class="headerlink" title="1.webpack是什么"></a>1.webpack是什么</h6><ul>
<li>打包工具(模块)</li>
<li>前端必不可少的工具</li>
</ul>
<h6 id="2-webpack的作用"><a href="#2-webpack的作用" class="headerlink" title="2. webpack的作用"></a>2. webpack的作用</h6><ul>
<li>打包（把多个文件打包成一个js文件，减少服务器压力、带宽）</li>
<li>转化（比如less/sass/ts）需要loader</li>
<li>优化（SPA越来越盛行，前端项目复杂度高,webpack可以对项目进行优化）</li>
</ul>
<h6 id="3-webpack构成"><a href="#3-webpack构成" class="headerlink" title="3. webpack构成"></a>3. webpack构成</h6><ul>
<li>入口 （entry）</li>
<li>出口 （output）</li>
<li>转化器 （loader）</li>
<li>插件 （plugins）</li>
<li>开发服务器 （devServer）</li>
<li>模式 （mode）</li>
</ul>
<h6 id="4-安装webpack"><a href="#4-安装webpack" class="headerlink" title="4. 安装webpack"></a>4. 安装webpack</h6><pre><code><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">npm install webpack-cli -g</span><br><span class="line"><span class="comment">// or</span></span><br><span class="line">yarn add webpack-cli -g</span><br><span class="line"><span class="comment">// 验证webpack环境已经OK ？</span></span><br><span class="line">webpack -v</span><br></pre></td></tr></table></figure>
</code></pre><h6 id="5-开发环境和生产环境"><a href="#5-开发环境和生产环境" class="headerlink" title="5. 开发环境和生产环境"></a>5. 开发环境和生产环境</h6><ul>
<li>开发环境(development)： 就是你平时编写代码的环境</li>
<li>生产环境(production): 项目开发完毕，部署上线</li>
</ul>
<h6 id="6-npm基本命令"><a href="#6-npm基本命令" class="headerlink" title="6. npm基本命令"></a>6. npm基本命令</h6><ul>
<li>生成package.json: <ul>
<li>npm init  </li>
<li>npm init -y</li>
</ul>
</li>
<li>下载线上环境包依赖<ul>
<li>npm install [包名,包名,包名…] –save</li>
<li>npm i [包名,包名,包名…] -S</li>
</ul>
</li>
<li>下载开发环境包依赖 <ul>
<li>npm install [包名,包名,包名…] –save–dev  </li>
<li>npm i [包名,包名,包名…] -D</li>
</ul>
</li>
</ul>
<h2 id="webpack4-x初探"><a href="#webpack4-x初探" class="headerlink" title="webpack4.x初探"></a>webpack4.x初探</h2><h6 id="1-跑一跑webpack"><a href="#1-跑一跑webpack" class="headerlink" title="1. 跑一跑webpack"></a>1. 跑一跑webpack</h6><p>&emsp;&emsp;当前项目下，新建src文件,src文件下新建index.js<br>&emsp;&emsp;index.js文件编写测试代码【console.log(‘Hello World’);】<br>&emsp;&emsp;将src下index.js打包为dist下bundle.js，执行如下:</p>
<pre><code><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">webpack src/index.js --output dist/bundle.js</span><br></pre></td></tr></table></figure>
</code></pre><h6 id="2-webpack-config-js配置文件"><a href="#2-webpack-config-js配置文件" class="headerlink" title="2. webpack.config.js配置文件"></a>2. webpack.config.js配置文件</h6><p>&emsp;&emsp;当前项目下执行npm init -y<br>&emsp;&emsp;当前项目下新增webpack.config.js<br>    <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    entry: &#123;</span><br><span class="line">        app: <span class="string">'./src/index.js'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    output:&#123;</span><br><span class="line">        filename: <span class="string">'bundle.js'</span>,</span><br><span class="line">        path: path.resolve(__dirname,<span class="string">'/dist'</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="built_in">module</span>: &#123;&#125;,</span><br><span class="line">    plugins: [],</span><br><span class="line">    devServer:&#123;&#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<h6 id="3-使用自定义webpack配置文件名-例：myself-config-js"><a href="#3-使用自定义webpack配置文件名-例：myself-config-js" class="headerlink" title="3. 使用自定义webpack配置文件名 例：myself.config.js"></a>3. 使用自定义webpack配置文件名 例：myself.config.js</h6><pre><code><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">webpack --config myself.config.js</span><br></pre></td></tr></table></figure>
</code></pre><h6 id="4-package-json配置运行命令"><a href="#4-package-json配置运行命令" class="headerlink" title="4. package.json配置运行命令"></a>4. package.json配置运行命令</h6><p>&emsp;&emsp;package.json文件scripts下配置命令<br>&emsp;&emsp;配置webpack开发环境(dev)/线上环境(build)命令如下<br>    <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"scripts"</span>: &#123;</span><br><span class="line">    <span class="string">"dev"</span>: <span class="string">"webpack --mode development"</span>,</span><br><span class="line">    <span class="string">"build"</span>: <span class="string">"webpack --mode production"</span>,</span><br><span class="line"> &#125;,</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;执行开发环境打包：npm run dev<br>&emsp;&emsp;执行线上环境打包：npm run build<br>&emsp;&emsp;mode:设置打包环境</p>
<h2 id="多入口、多出口、html插件使用"><a href="#多入口、多出口、html插件使用" class="headerlink" title="多入口、多出口、html插件使用"></a>多入口、多出口、html插件使用</h2><h6 id="1-多入口打包"><a href="#1-多入口打包" class="headerlink" title="1. 多入口打包"></a>1. 多入口打包</h6><pre><code><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    entry: [<span class="string">'./src/index.js'</span>,<span class="string">'./src/index2.js'</span>],</span><br><span class="line">    output:&#123;</span><br><span class="line">        filename: <span class="string">'bundle.js'</span>,</span><br><span class="line">        path: path.resolve(__dirname,<span class="string">'dist'</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
</code></pre><h6 id="2-多出口"><a href="#2-多出口" class="headerlink" title="2. 多出口"></a>2. 多出口</h6><pre><code><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    entry: &#123;</span><br><span class="line">        app: <span class="string">'./src/index'</span>,</span><br><span class="line">        main: <span class="string">'./src/index2.js'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    output:&#123;</span><br><span class="line">        filename: <span class="string">'[name].bundle.js'</span>,</span><br><span class="line">        path: path.resolve(__dirname,<span class="string">'dist'</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
</code></pre><h6 id="3-html-webpack-plugin"><a href="#3-html-webpack-plugin" class="headerlink" title="3. html-webpack-plugin"></a>3. html-webpack-plugin</h6><p>&emsp;&emsp;作用：生成页面<br>&emsp;&emsp;依赖webpack webpack-cli<br>&emsp;&emsp;安装插件：npm i html-webpack-plugin -D<br>&emsp;&emsp;使用如下<br>    <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">'html-webpack-plugin'</span>);</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    ...,</span><br><span class="line">    plugins:[</span><br><span class="line">        <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">            template: <span class="string">'./src/index.html'</span>,</span><br><span class="line">            title: <span class="string">'可配置标题'</span>,</span><br><span class="line">            hash: <span class="literal">true</span>,</span><br><span class="line">            minify:&#123;</span><br><span class="line">               collapseWhitespace: <span class="literal">true</span></span><br><span class="line">            &#125;,</span><br><span class="line">         &#125;)</span><br><span class="line">    ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<pre><code><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;<span class="name">%=</span> <span class="attr">htmlWebpackPlugin.options.title</span>%&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--htmlWebpackPlugin 为插件定义名称,与js中自定义的插件名无关 --&gt;</span></span><br></pre></td></tr></table></figure>
</code></pre><p>参数解析</p>
<ul>
<li>title：HTML文档标题</li>
<li>filename: 文件名,默认为index.html，可设置</li>
<li>template: 版本地址,默认查询 src/index.ejs,若未查到,将自动生成模板</li>
<li>templateParameters: 允许重新模板参数</li>
<li>inject: 注入，允许对head、body等添加脚本</li>
<li>favicon: 设置网页顶部图标</li>
<li>meta: 在head中注入mate标签</li>
<li>base: 设置公共地址，如 <a href="https://example.com/path/page.html" target="_blank" rel="noopener">https://example.com/path/page.html</a></li>
<li>minify: 是否压缩</li>
<li>hash: 是否生成哈希值,若为true将为所以注入文件加入哈希值</li>
<li>cache: 是否启用缓存，仅在文件有改动后才更新文件</li>
<li>showErrors: 是否报错</li>
<li>chunks: 是否仅允许添加指定块</li>
<li>chunksSortMode: 设置块加载排序方式</li>
<li>excludeChunks: 不允许加入的块</li>
<li>xhtml: 是否遵照xhtml加入link标签</li>
</ul>
<h2 id="HTML插件优化、服务器、热更新"><a href="#HTML插件优化、服务器、热更新" class="headerlink" title="HTML插件优化、服务器、热更新"></a>HTML插件优化、服务器、热更新</h2><h6 id="1-生成多页面"><a href="#1-生成多页面" class="headerlink" title="1. 生成多页面"></a>1. 生成多页面</h6><pre><code><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">plugins: [</span><br><span class="line">    <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">        template: <span class="string">'./src/index.html'</span>,</span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">        filename: <span class="string">'index2.html'</span>,</span><br><span class="line">        template: <span class="string">'./src/index2.html'</span>,</span><br><span class="line">    &#125;),</span><br><span class="line">    ...</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
</code></pre><p>&emsp;&emsp;配置多个页面时，此处一定要配置filename<br>&emsp;&emsp;mpa项目可用node读取文件，来生成多个模板<br>&emsp;&emsp;默认js都会打入模板内</p>
<h6 id="2-指定文件打入指定模板"><a href="#2-指定文件打入指定模板" class="headerlink" title="2. 指定文件打入指定模板"></a>2. 指定文件打入指定模板</h6><p>&emsp;&emsp;将app文件打入index.html，将main文件打入index2.html,配置如下<br>    <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    entry: &#123;</span><br><span class="line">        app: <span class="string">'./src/index'</span>,</span><br><span class="line">        main: <span class="string">'./src/index2.js'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    plugins: [</span><br><span class="line">        <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">            chunks:[<span class="string">'app'</span>],</span><br><span class="line">            template: <span class="string">'./src/index.html'</span>,</span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">            chunks:[<span class="string">'main'</span>],</span><br><span class="line">            filename: <span class="string">'index2.html'</span>,</span><br><span class="line">            template: <span class="string">'./src/index2.html'</span>,</span><br><span class="line">        &#125;)</span><br><span class="line">    ],</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<h6 id="3-clean-webpack-plugin"><a href="#3-clean-webpack-plugin" class="headerlink" title="3. clean-webpack-plugin"></a>3. clean-webpack-plugin</h6><p>&emsp;&emsp;作用：清除文件/文件夹<br>&emsp;&emsp;使用方式：<br>    <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123;CleanWebpackPlugin&#125; = <span class="built_in">require</span>(<span class="string">'clean-webpack-plugin'</span>);</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    ...,</span><br><span class="line">    plugins: [</span><br><span class="line">        <span class="keyword">new</span> CleanWebpackPlugin(),</span><br><span class="line">    ],</span><br><span class="line">    devServer:&#123;&#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<h6 id="4-devServer"><a href="#4-devServer" class="headerlink" title="4. devServer"></a>4. devServer</h6><p>&emsp;&emsp;下载: npm install webpack-dev-server<br>&emsp;&emsp;package.json中配置启动项</p>
<pre><code><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"scripts"</span>: &#123;</span><br><span class="line">    <span class="string">"dev"</span>: <span class="string">"webpack --mode development"</span>,</span><br><span class="line">    <span class="string">"build"</span>: <span class="string">"webpack --mode production"</span>,</span><br><span class="line">    <span class="string">"start:dev"</span>: <span class="string">"webpack-dev-server"</span></span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
</code></pre><p>&emsp;&emsp;配置一个基本的devServer</p>
<pre><code><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    ...,</span><br><span class="line">    devServer:&#123;</span><br><span class="line">        <span class="comment">// 设置服务器访问的基本目录</span></span><br><span class="line">        contentBase: path.resolve(__dirname,<span class="string">'dist'</span>),</span><br><span class="line">        <span class="comment">// 服务IP地址，本地可设置 localhost / 127.0.0.1</span></span><br><span class="line">        host: <span class="string">'localhost'</span>,</span><br><span class="line">        <span class="comment">// 设置端口</span></span><br><span class="line">        port: <span class="string">'8090'</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
</code></pre><p>&emsp;&emsp;项目中我们发现dist文件为空，因为devServer将contentBase下的文件放到了活动内存中<br>&emsp;&emsp;devServer支持自动刷新</p>
<h6 id="5-热更新"><a href="#5-热更新" class="headerlink" title="5. 热更新"></a>5. 热更新</h6><p>&emsp;&emsp;作用：不重新加载整个文档，保留之前的操作，仅对有变动的部分更改<br>    <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    ...,</span><br><span class="line">    devServer:&#123;</span><br><span class="line">        <span class="comment">// 设置服务器访问的基本目录</span></span><br><span class="line">        contentBase: path.resolve(__dirname,<span class="string">'dist'</span>),</span><br><span class="line">        <span class="comment">// 服务IP地址，本地可设置 localhost / 127.0.0.1</span></span><br><span class="line">        host: <span class="string">'localhost'</span>,</span><br><span class="line">        <span class="comment">// 设置端口</span></span><br><span class="line">        port: <span class="string">'8090'</span>,</span><br><span class="line">        <span class="comment">// 是否开启热更新</span></span><br><span class="line">    &#125;,</span><br><span class="line">    plugins: [</span><br><span class="line">        <span class="keyword">new</span> webpack.HotModuleReplacementPlugin()</span><br><span class="line">    ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<h6 id="6-实现跨域"><a href="#6-实现跨域" class="headerlink" title="6, 实现跨域"></a>6, 实现跨域</h6><p>&emsp;&emsp;利用devServer实现跨域<br>&emsp;&emsp;将所有/api开头的请求，代理至本机3000端口，配置如下<br>    <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">devServer: &#123;</span><br><span class="line">    proxy: &#123;</span><br><span class="line">      <span class="string">'/api'</span>: &#123;</span><br><span class="line">        target: <span class="string">'http://localhost:3000'</span>,</span><br><span class="line">        pathRewrite: &#123;<span class="string">'^/api'</span> : <span class="string">''</span>&#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;pathRewrite：重写</p>
<h2 id="loader作用，处理css文件及压缩方式"><a href="#loader作用，处理css文件及压缩方式" class="headerlink" title="loader作用，处理css文件及压缩方式"></a>loader作用，处理css文件及压缩方式</h2><h6 id="1-loader介绍"><a href="#1-loader介绍" class="headerlink" title="1. loader介绍"></a>1. loader介绍</h6><p>&emsp;&emsp;作用：加载器、转化器<br>&emsp;&emsp;比如：less/scss转成css；ES7/8/9、JSX转成js<br>&emsp;&emsp;loader从后向前加载</p>
<h6 id="2-css-loader"><a href="#2-css-loader" class="headerlink" title="2. css loader"></a>2. css loader</h6><p>&emsp;&emsp;我们编写了一个app.css文件，并在js文件中引用了它<br>    <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">"./app.css"</span>;</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;此时工具将会报编译错误，提示我们缺少loader，下面我是使用loader将其转化<br>&emsp;&emsp;下载css相关的两个最核心loader:style-loader与css-loader<br>&emsp;&emsp;loader基础配置如下:<br>    <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    <span class="built_in">module</span>: &#123;</span><br><span class="line">        rules: [</span><br><span class="line">            &#123;</span><br><span class="line">                test: <span class="regexp">/\.css$/</span>,</span><br><span class="line">                loader:[<span class="string">'style-loader'</span>,<span class="string">'css-loader'</span>],</span><br><span class="line">                exclude: <span class="regexp">/node_modules/</span></span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>关于loader的写法</p>
<ul>
<li>loader: [‘loader1’,’loader2’,…]</li>
<li>use: [‘loader1’,’loader2’,…]</li>
<li>use: [{loader: ‘loader1’},{ loader: ‘loader2’ },…]</li>
</ul>
<p>css-loader先于style-loader解析<br>css-loader用来解析文件，style-loader将注入到模板内(在模板的head标签内注入style标签，并将样式放入style标签内)</p>
<h6 id="3-文件压缩"><a href="#3-文件压缩" class="headerlink" title="3. 文件压缩"></a>3. 文件压缩</h6><p>&emsp;&emsp;4.x版本之前，压缩插件使用uglifyjs-webpack-plugin<br>&emsp;&emsp;4.x版本之后，仅需将模式改为线上模式，将自动生成压缩文件</p>
<h2 id="处理图片，分离css"><a href="#处理图片，分离css" class="headerlink" title="处理图片，分离css"></a>处理图片，分离css</h2><h6 id="1-图片处理"><a href="#1-图片处理" class="headerlink" title="1. 图片处理"></a>1. 图片处理</h6><p>&emsp;&emsp;当我们在css中引用一张路径正确的图片时,编译工具会报错（当时直接引入css的时候也是这样）<br>&emsp;&emsp;图片转化我们经常会用到两个loader: url-loader和file-loader<br>&emsp;&emsp;url-loader: 支持js引入文件,并将文件输出到output的文件夹<br>&emsp;&emsp;file-loader与url-loader相似，但比url-loader功能还要强大<br>&emsp;&emsp;url-loader使用如下：<br>    <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">       &#123;</span><br><span class="line">          test: <span class="regexp">/\.(png|jpg|gif|jpeg)$/i</span>,</span><br><span class="line">          use: &#123;</span><br><span class="line">                   loader: <span class="string">'url-loader'</span>,</span><br><span class="line">                   options: &#123;</span><br><span class="line">                   limit: <span class="number">50</span>*<span class="number">1000</span>,</span><br><span class="line">                   outputPath: <span class="string">'image'</span>,</span><br><span class="line">               &#125;</span><br><span class="line">          &#125;,</span><br><span class="line">          exclude: <span class="regexp">/node_modules/</span></span><br><span class="line">       &#125;</span><br><span class="line">    ]</span><br><span class="line"> &#125;,</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;背景图小于50kb时，图片会生成base64位</p>
<h6 id="2-图片分离"><a href="#2-图片分离" class="headerlink" title="2. 图片分离"></a>2. 图片分离</h6><p>&emsp;&emsp;图片分离插件 extract-text-webpack-plugin 4.0版后已废弃<br>&emsp;&emsp;4.0版后请使用mini-css-extract-plugin<br>&emsp;&emsp;使用如下<br>    <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> MiniCssExtractPlugin = <span class="built_in">require</span>(<span class="string">'mini-css-extract-plugin'</span>);</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">      <span class="built_in">module</span>: &#123;</span><br><span class="line">              rules: [</span><br><span class="line">                  &#123;</span><br><span class="line">                      test: <span class="regexp">/\.css$/</span>,</span><br><span class="line">                      loader:[&#123;</span><br><span class="line">                          loader: MiniCssExtractPlugin.loader,</span><br><span class="line">                          options:&#123;</span><br><span class="line">                              publicPath: <span class="string">''</span></span><br><span class="line">                          &#125;</span><br><span class="line">                      &#125;,<span class="string">'css-loader'</span>],</span><br><span class="line">                      exclude: <span class="regexp">/node_modules/</span></span><br><span class="line">                  &#125;,&#123;</span><br><span class="line">                      test: <span class="regexp">/\.(png|jpg|gif|jpeg)$/i</span>,</span><br><span class="line">                      use: &#123;</span><br><span class="line">                          loader: <span class="string">'url-loader'</span>,</span><br><span class="line">                           options: &#123;</span><br><span class="line">                              outputPath: <span class="string">'image'</span>,</span><br><span class="line">                              limit: <span class="number">50</span>*<span class="number">1000</span></span><br><span class="line">                          &#125;</span><br><span class="line">                      &#125;,</span><br><span class="line">                      exclude: <span class="regexp">/node_modules/</span></span><br><span class="line">                  &#125;</span><br><span class="line">              ]</span><br><span class="line">      &#125;,</span><br><span class="line">      plugins: [</span><br><span class="line">             <span class="keyword">new</span> MiniCssExtractPlugin(&#123;</span><br><span class="line">                 filename: <span class="string">'[name].css'</span>,</span><br><span class="line">                 chunkFilename: <span class="string">'[id].css'</span></span><br><span class="line">             &#125;),</span><br><span class="line">           </span><br><span class="line">         ],</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="less-sass处理，添加前缀，消除冗余css"><a href="#less-sass处理，添加前缀，消除冗余css" class="headerlink" title="less/sass处理，添加前缀，消除冗余css"></a>less/sass处理，添加前缀，消除冗余css</h2><h6 id="1-处理less"><a href="#1-处理less" class="headerlink" title="1. 处理less"></a>1. 处理less</h6><p>&emsp;&emsp;下载转化less的loader： npm install less less-loader -D<br>&emsp;&emsp;配置如下：<br>    <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">        &#123;</span><br><span class="line">            test: <span class="regexp">/\.less$/</span>,</span><br><span class="line">            use: [<span class="string">'style-loader'</span>,<span class="string">'css-loader'</span>,<span class="string">'less-loader'</span>],</span><br><span class="line">            exclude: <span class="regexp">/node_modules/</span>,</span><br><span class="line">        &#125;</span><br><span class="line">     ]</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure></p>
<h6 id="2-处理sass"><a href="#2-处理sass" class="headerlink" title="2. 处理sass"></a>2. 处理sass</h6><p>&emsp;&emsp;下载转化sass的loader： npm install node-sass sass-loader -D<br>&emsp;&emsp;配置如下：<br>    <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">        &#123;</span><br><span class="line">            test: <span class="regexp">/\.s(a|c)ss/</span>,</span><br><span class="line">            use: [<span class="string">'style-loader'</span>,<span class="string">'css-loader'</span>,<span class="string">'sass-loader'</span>],</span><br><span class="line">            exclude: <span class="regexp">/node_modules/</span></span><br><span class="line">        &#125;</span><br><span class="line">     ]</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure></p>
<h6 id="3-自动添加css前缀"><a href="#3-自动添加css前缀" class="headerlink" title="3. 自动添加css前缀"></a>3. 自动添加css前缀</h6><p>&emsp;&emsp;CSS预处理器： postCss<br>&emsp;&emsp;下载预处理器loader：npm install postcss-loader autoprefixer -D<br>&emsp;&emsp;项目根目录下新增postcss配置文件： postcss.config.js，配置如下<br>    <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    plugins: [</span><br><span class="line">        <span class="built_in">require</span>(<span class="string">'autoprefixer'</span>)</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;webpack配置如下<br>      <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>: &#123;</span><br><span class="line">     rules: [</span><br><span class="line">          &#123;</span><br><span class="line">               test: <span class="regexp">/\.css$/</span>,</span><br><span class="line">               use: [<span class="string">'style-loader'</span>,<span class="string">'css-loader'</span>,<span class="string">'postcss-loader'</span>],</span><br><span class="line">               exclude: <span class="regexp">/node_modules/</span></span><br><span class="line">          &#125;</span><br><span class="line">     ]</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;目前遇到项目中不显示前缀，但demo中就可以，还在排查原因</p>
<h6 id="4-消除冗余CSS代码"><a href="#4-消除冗余CSS代码" class="headerlink" title="4. 消除冗余CSS代码"></a>4. 消除冗余CSS代码</h6><p>&emsp;&emsp;下载依赖：npm install purifycss-webpack purify-css -D<br>&emsp;&emsp;paths参数用来设置需要分析的路径地址<br>&emsp;&emsp;配置如下：<br>    <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">   </span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"><span class="keyword">const</span> glob = <span class="built_in">require</span>(<span class="string">'glob'</span>);</span><br><span class="line"><span class="keyword">const</span> PurifyCssPlugin = <span class="built_in">require</span>(<span class="string">'purifycss-webpack'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    plugins: [</span><br><span class="line">        <span class="keyword">new</span> PurifyCssPlugin(&#123;</span><br><span class="line">            paths: glob.sync(path.join(__dirname, <span class="string">'dist/*.html'</span>))</span><br><span class="line">        &#125;)</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="SourceMap、babel、react环境配置"><a href="#SourceMap、babel、react环境配置" class="headerlink" title="SourceMap、babel、react环境配置"></a>SourceMap、babel、react环境配置</h2><h6 id="1-SourceMap"><a href="#1-SourceMap" class="headerlink" title="1. SourceMap"></a>1. SourceMap</h6><p>&emsp;&emsp;webpack 4.x版本默认在development环境下自动开启调试模式<br>&emsp;&emsp;webpack 3.采用sourceMap</p>
<pre><code><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>: &#123;</span><br><span class="line">     ...,</span><br><span class="line">     devTool: <span class="string">'source-map'</span></span><br><span class="line"> &#125;,</span><br></pre></td></tr></table></figure>
</code></pre><h6 id="2-babel"><a href="#2-babel" class="headerlink" title="2. babel"></a>2. babel</h6><p>作用：</p>
<ul>
<li>babel用来编译js</li>
<li>能够轻松使用ESnext转化</li>
<li>支持jsx等语法</li>
</ul>
<p>&emsp;&emsp;babel核心模块： babel-loader @babel/core @babel/preset-env<br>&emsp;&emsp;配置如下：</p>
<pre><code><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>: &#123;</span><br><span class="line">      rules: [</span><br><span class="line">           test: <span class="regexp">/\.jsx?$/</span>,</span><br><span class="line">           exclude: <span class="regexp">/node_modules/</span>,</span><br><span class="line">           use: [&#123;</span><br><span class="line">                loader: <span class="string">'babel-loader'</span>,</span><br><span class="line">                options: &#123;</span><br><span class="line">                     presets: [<span class="string">'@babel/preset-env'</span>]</span><br><span class="line">           &#125;]</span><br><span class="line">      ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</code></pre><h6 id="3-支持JSX语法"><a href="#3-支持JSX语法" class="headerlink" title="3. 支持JSX语法"></a>3. 支持JSX语法</h6><p>&emsp;&emsp;下载插件：npm install react react-dom @babel/preset-react -D<br>&emsp;&emsp;项目根目录下新建babel配置文件.babelrc.json<br>    <figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"> <span class="attr">"presets"</span>: [<span class="string">"@babel/preset-react"</span>],</span><br><span class="line">   <span class="attr">"env"</span>: &#123;</span><br><span class="line">     <span class="attr">"development"</span>: &#123;</span><br><span class="line">       <span class="attr">"presets"</span>: [[<span class="string">"@babel/preset-react"</span>, &#123; <span class="attr">"development"</span>: <span class="literal">true</span> &#125;]]</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<h2 id="JSON配置、模块化设置、静态资源、插件"><a href="#JSON配置、模块化设置、静态资源、插件" class="headerlink" title="JSON配置、模块化设置、静态资源、插件"></a>JSON配置、模块化设置、静态资源、插件</h2><h6 id="1-使用模块化"><a href="#1-使用模块化" class="headerlink" title="1. 使用模块化"></a>1. 使用模块化</h6><p>&emsp;&emsp;以提取rules为例<br>&emsp;&emsp;新建rules模块文件webpack.rule.js<br>&emsp;&emsp;复制模块规则并通过module.exports导出<br>&emsp;&emsp;webpack配置文件引入如下<br>    <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> ruleConfig = <span class="built_in">require</span>(<span class="string">'./webpack.rule'</span>);</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    <span class="built_in">module</span>: &#123;</span><br><span class="line">        rules: ruleConfig</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;在webpack中使用JSON</p>
<ul>
<li>webpack 3.X之前使用json-loader</li>
<li>webpack 3.X之后默认可自动识别</li>
</ul>
<h6 id="2-静态资源输出"><a href="#2-静态资源输出" class="headerlink" title="2. 静态资源输出"></a>2. 静态资源输出</h6><p>&emsp;&emsp;使用插件copy-webpack-plugin<br>&emsp;&emsp;配置如下<br>    <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> CopyWebpackPlugin = <span class="built_in">require</span>(<span class="string">'copy-webpack-plugin'</span>);</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    plugins: [</span><br><span class="line">        <span class="keyword">new</span> CopyWebpackPlugin([</span><br><span class="line">           &#123;<span class="attr">from</span> : path.resolve(__dirname,<span class="string">'src/assets'</span>),<span class="attr">to</span>: <span class="string">'./assets'</span>&#125;,</span><br><span class="line">        ])</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;注：默认打入dist文件</p>
<h2 id="优雅使用第三方库、提取JS文件、优化"><a href="#优雅使用第三方库、提取JS文件、优化" class="headerlink" title="优雅使用第三方库、提取JS文件、优化"></a>优雅使用第三方库、提取JS文件、优化</h2><h6 id="1-使用第三方库"><a href="#1-使用第三方库" class="headerlink" title="1. 使用第三方库"></a>1. 使用第三方库</h6><p>&emsp;&emsp; ① 通过npm引入<br>&emsp;&emsp; ② 通过webpack内置插件ProvidePlugin,向全局暴露，使用方法如下<br>    <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> webpack =  <span class="built_in">require</span>(<span class="string">'webpack'</span>);</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    plugins: [</span><br><span class="line">        <span class="keyword">new</span> webpack.ProvidePlugin(&#123;</span><br><span class="line">            $: <span class="string">'jquery'</span>,</span><br><span class="line">        &#125;)</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;通过ProvidePlugin引入与通过import引入的区别：</p>
<ul>
<li>通过import引入后，无论是否使用，都会被打包，这样会产生大量冗余js</li>
<li>ProvidePlugin只有在使用后才会打包</li>
</ul>
<h6 id="2-提取JS文件"><a href="#2-提取JS文件" class="headerlink" title="2. 提取JS文件"></a>2. 提取JS文件</h6><p>&emsp;&emsp;在webpack 3.x及之前使用CommonsChunkPlugin<br>&emsp;&emsp;webpack 4.x使用SplitChunksPlugin,使用如下<br>    <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>);</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    optimization: &#123;</span><br><span class="line">        splitChunks: &#123;</span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;最后，这套课程老肖录制于18年初，截至到现在已经有一些插件、loader或写法发生了变化，我已对其做了少量调整，即便如此，对于新手而言这一定是一个很棒的课。<br>&emsp;&emsp;这套课使自己快速入了webpack的门，每看一遍都有新收获，后面我将再写一篇由浅入深更全面、更深入的教程课，但老肖这套，唯有纸笔记之算自己才觉得可以算完结，好在我做到了。</p>

      
    </div>
      <div id="remark"></div>
    <div class="article-info article-info-index">
      
      <a href="/2019/07/11/webpackStudyQuick/" class="archive-article-date">
  	<time datetime="2019-07-11T04:19:24.000Z" itemprop="datePublished"><i class="icon-clock"></i>2019-07-11</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/webpack/">webpack</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/webpack-4-0/">webpack 4.0</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/webpack教程/">webpack教程</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<i class="icon-price-tags"></i>
	<a class="article-category-link" href="/categories/个人博客/">个人博客</a>
	</div>


      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-webpackOptimization" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/07/04/webpackOptimization/">webpack优化</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><abbr style="font-weight:bold;color:orange;font-size: 28px;">开发阶段</abbr></p>
<p>1 开启多核压缩JS<br>&emsp;&emsp;uglifyjs-webpack-plugin</p>
<p>2 兼容面板-webpack速度显示<br>&emsp;&emsp;speed-measure-webpack-plugin</p>
<p>3 开启通知面板<br>&emsp;&emsp;webpack-build-notifier</p>
<p>4 开启打包进度<br>&emsp;&emsp;progress-bar-webpack-plugin</p>
<p>5 开发面板更清晰<br>&emsp;&emsp;webpack-dashboard</p>
<p>6 开启窗口的标题<br>&emsp;&emsp;node-bash-title</p>
<p><abbr style="font-weight:bold;color:orange;font-size: 28px;">上线阶段</abbr></p>
<p>1.es6不需要编译</p>
<p>2.前端缓存负载<br>&emsp;&emsp;webpack-manifest-plugin   </p>
<p>3.真正的loading<br>    <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">new HtmlWebpackPlugin(&#123;</span><br><span class="line">    loading:&#123;</span><br><span class="line">        html: &apos;加载中......&apos;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<pre><code>```html
 &lt;%= htmlWebpackPlugin.options.loading.html %&gt; 
``` 
</code></pre><p>4.分析打包结果<br>&emsp;&emsp;bundlesize<br>&emsp;&emsp;webpack-chart</p>
<p>5.文件压缩<br>&emsp;&emsp;uglifyjs-webpack-plugin<br>&emsp;&emsp;webpack-parallel-uglify-plugin</p>
<p>6.happypack</p>
<p>7.devtool</p>
<p>8.cache-loader      </p>

      
    </div>
      <div id="remark"></div>
    <div class="article-info article-info-index">
      
      <a href="/2019/07/04/webpackOptimization/" class="archive-article-date">
  	<time datetime="2019-07-04T09:36:29.000Z" itemprop="datePublished"><i class="icon-clock"></i>2019-07-04</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/webpack/">webpack</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/webpack优化/">webpack优化</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/前端打包工具/">前端打包工具</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<i class="icon-price-tags"></i>
	<a class="article-category-link" href="/categories/个人博客/">个人博客</a>
	</div>


      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-applets-rich-text" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/05/27/applets-rich-text/">小程序之rich-text如何生成渲染DOM</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>&emsp;&emsp; 今天要吐血紧急发一篇关于小程序富文本渲染的<br>&emsp;&emsp; 之所以吐血,是因为小程序wxs语法出错无法打印，无法调试，更无从知道原因<br>&emsp;&emsp; 根据字符串,解析正则,此方法不是万能的，但，完全可以帮你省很大力气,当然它目前仅适用我的项目,稍改动一下即可</p>
<p>&emsp;&emsp; 以下为 wxs 文件内,module=m1<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">    function matchEmoticon(content,regStr)&#123;</span><br><span class="line">        var node = [&#123;</span><br><span class="line">              type: &apos;node&apos;,</span><br><span class="line">              name: &apos;span&apos;,</span><br><span class="line">              children: []</span><br><span class="line">          &#125;];</span><br><span class="line"></span><br><span class="line">          if(getRegExp(regStr,&quot;g&quot;).test(content)) &#123;</span><br><span class="line">              var contentCopy =  content;</span><br><span class="line">              while (contentCopy.length &gt; 0 &amp;&amp; getRegExp(regStr,&quot;g&quot;).test(contentCopy))&#123;</span><br><span class="line"></span><br><span class="line">                  var result = getRegExp(regStr).exec(contentCopy);</span><br><span class="line">                  var searchIndex = contentCopy.search(getRegExp(regStr));</span><br><span class="line"></span><br><span class="line">                  if(searchIndex == 0)&#123;</span><br><span class="line">                      node[0].children.push(&#123;</span><br><span class="line">                          type: &quot;node&quot;,</span><br><span class="line">                          name: &apos;img&apos;,</span><br><span class="line">                          attrs : &#123; &quot;src&quot;: &quot;https://www.mifengapp.com/resources/emoticon/&quot; +  result[1]  +&quot;.png&quot;,</span><br><span class="line">                          style : &quot;width: 20px;height:20px;padding: 0 1px&quot; &#125;,</span><br><span class="line">                          children: []</span><br><span class="line">                      &#125;);</span><br><span class="line"></span><br><span class="line">                    contentCopy = contentCopy.slice(result[0].length);</span><br><span class="line"></span><br><span class="line">                  &#125;else&#123;</span><br><span class="line">                     node[0].children.push(&#123;</span><br><span class="line">                          type: &quot;node&quot;,</span><br><span class="line">                          name: &apos;span&apos;,</span><br><span class="line">                          children: [&#123;</span><br><span class="line">                              type: &apos;text&apos;,</span><br><span class="line">                              text: contentCopy.slice(0,searchIndex)</span><br><span class="line">                          &#125;]</span><br><span class="line">                      &#125;);</span><br><span class="line"></span><br><span class="line">                      contentCopy = contentCopy.slice(searchIndex);</span><br><span class="line">                  &#125;</span><br><span class="line">             &#125;</span><br><span class="line"></span><br><span class="line">             if(contentCopy.length &gt; 0)&#123;</span><br><span class="line">                node[0].children.push(&#123;</span><br><span class="line">                    type: &quot;node&quot;,</span><br><span class="line">                    name: &apos;span&apos;,</span><br><span class="line">                    children: [&#123;</span><br><span class="line">                        type: &apos;text&apos;,</span><br><span class="line">                        text: contentCopy</span><br><span class="line">                    &#125;]</span><br><span class="line">                &#125;);</span><br><span class="line">             &#125;</span><br><span class="line"></span><br><span class="line">          &#125;else&#123;</span><br><span class="line">              node[0].children.push(&#123;</span><br><span class="line">                  type: &apos;node&apos;,</span><br><span class="line">                  name: &apos;span&apos;,</span><br><span class="line">                  children: [&#123;</span><br><span class="line">                      type: &apos;text&apos;,</span><br><span class="line">                      text: content</span><br><span class="line">                  &#125;]</span><br><span class="line">              &#125;)</span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">          return node;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">module.exports = &#123;</span><br><span class="line">    matchEmoticon: matchEmoticon</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp; 以下为 wxml文件内调用上述方法<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;rich-text nodes=&quot;&#123;&#123;m1.matchEmoticon(&quot;监督检查吃顿饭呢看到基础酒店吧地方好的宝贝底线很好的716969797979SSS1&quot;,&quot;[\uE000]([\d]+)[\uE001]&quot;)&#125;&#125;&quot;&gt;&lt;/rich-text&gt;</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;注：<br>&emsp;&emsp; ① 为什么不用ES6？<br>&emsp;&emsp;&emsp;&emsp;&emsp;wxs内暂不支持ES6<br>&emsp;&emsp; ② 为什么使用getRegExp而不是RegExp或字面量创建？<br>&emsp;&emsp;&emsp;&emsp;&emsp;小程序内正则使用封装的getRegExp,否则会无法解析<br>&emsp;&emsp; ③ 为什么不提取getRegExp(regStr,”g”)做公共变量?<br>&emsp;&emsp;&emsp;&emsp;&emsp;不知道内部如何封装的，提取后会无法解析<br>&emsp;&emsp; ④ 为什么用了exec还要用search?<br>&emsp;&emsp;&emsp;&emsp;&emsp;因为需要获取下标值,虽然exec的返回值result有result[0]和result[1],但是没有result.index<br>&emsp;&emsp; ⑤ 代码异常了会怎样？<br>&emsp;&emsp;&emsp;&emsp;&emsp;内部应该做了捕获处理,会直接返回空</p>
<p>&emsp;&emsp; 希望这些问题后续能够解决，毕竟不太优雅.</p>

      
    </div>
      <div id="remark"></div>
    <div class="article-info article-info-index">
      
      <a href="/2019/05/27/applets-rich-text/" class="archive-article-date">
  	<time datetime="2019-05-27T03:29:09.000Z" itemprop="datePublished"><i class="icon-clock"></i>2019-05-27</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/rich-text/">rich-text</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/前端/">前端</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/原创/">原创</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/微信小程序/">微信小程序</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<i class="icon-price-tags"></i>
	<a class="article-category-link" href="/categories/个人博客/">个人博客</a>
	</div>


      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-regexp" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/13/regexp/">前端源码里的那些正则</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>&emsp;&emsp; 通读了一遍老姚的<a href="https://zhuanlan.zhihu.com/p/29707385" target="_blank" rel="noopener">《JavaScript 正则表达式迷你书》</a>个人收获极多。<br>&emsp;&emsp; 忽想到之前学源码时，那些晦涩难懂的正则表达式,或者防不胜防的『骚操作』,我遂决定将其摘出，细细品味。</p>
<h3 id="jQuery"><a href="#jQuery" class="headerlink" title="jQuery"></a>jQuery</h3><pre><code>1. 驼峰命名

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">var camelizeRE = /-(\w)/g;</span><br><span class="line">var camelize = cached(function (str) &#123;</span><br><span class="line">  return str.replace(camelizeRE, function (_, c) &#123; return c ? c.toUpperCase() : &apos;&apos;; &#125;)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">/* cached为缓存函数，可忽略，核心代码修改如下 */</span><br><span class="line"></span><br><span class="line">var camelizeRE = /-(\w)/g;</span><br><span class="line">var camelize = function (str) &#123;</span><br><span class="line">  return str.replace(camelizeRE, function (_, c) &#123; return c ? c.toUpperCase() : &apos;&apos;; &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"> *  ① camelizeRE正则捕获所有连字符[-]后的首个元素</span><br><span class="line"> *  ② _ 为符合正则的部分,c为正则$1[第一个括号包裹的内容]捕获到的元素，即我们的目标子符</span><br><span class="line"> *  ③ 若该字符存在,则大写</span><br><span class="line"> */</span><br></pre></td></tr></table></figure>
</code></pre>
      
    </div>
      <div id="remark"></div>
    <div class="article-info article-info-index">
      
      <a href="/2019/03/13/regexp/" class="archive-article-date">
  	<time datetime="2019-03-13T03:20:49.000Z" itemprop="datePublished"><i class="icon-clock"></i>2019-03-13</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/前端/">前端</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/正则/">正则</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/源码/">源码</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<i class="icon-price-tags"></i>
	<a class="article-category-link" href="/categories/个人博客/">个人博客</a>
	</div>


      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
  
    <nav id="page-nav">
      <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
    </nav>
  


      </div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2019 谢雨轩
    	</div>
      	<div class="footer-right">虽然生的丑 毕竟想的美</div>
    </div>
  </div>
</footer>

    </div>
    <script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: false,
		animate: true,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: true,
		root: "/",
		innerArchive: true
	}
</script>

<script src="/./main.js"></script>


    
<div class="tools-col">
  <ul class="btn-wrap">
    
      <li class="chose" data-hook="tools-section-all"><span class="text">全部</span><i class="icon-book"></i></li>
    
    
      <li data-hook="tools-section-tag"><span class="text">标签</span><i class="icon-price-tags"></i></li>
    
    
      <li data-hook="tools-section-friends"><span class="text">友链</span><i class="icon-link"></i></li>
    
    
      <li data-hook="tools-section-me"><span class="text">我</span><i class="icon-smile"></i></li>
    
  </ul>
  <div class="tools-wrap">
    
    	<section class="tools-section tools-section-all chose">
    	</section>
    

    
    	<section class="tools-section tools-section-tag">
    			<div class="widget tagcloud" id="js-tagcloud">
    				<a href="/tags/FHS/" style="font-size: 11.67px;">FHS</a> <a href="/tags/css-hack/" style="font-size: 10px;">css hack</a> <a href="/tags/excel表格导出/" style="font-size: 10px;">excel表格导出</a> <a href="/tags/jquery/" style="font-size: 10px;">jquery</a> <a href="/tags/jquery源码/" style="font-size: 10px;">jquery源码</a> <a href="/tags/jquery源码教程/" style="font-size: 10px;">jquery源码教程</a> <a href="/tags/js原型/" style="font-size: 10px;">js原型</a> <a href="/tags/license/" style="font-size: 10px;">license</a> <a href="/tags/linux/" style="font-size: 11.67px;">linux</a> <a href="/tags/linux操作/" style="font-size: 10px;">linux操作</a> <a href="/tags/linux文件/" style="font-size: 10px;">linux文件</a> <a href="/tags/linux环境变量/" style="font-size: 10px;">linux环境变量</a> <a href="/tags/node/" style="font-size: 10px;">node</a> <a href="/tags/nodejs/" style="font-size: 10px;">nodejs</a> <a href="/tags/rich-text/" style="font-size: 10px;">rich-text</a> <a href="/tags/underscore/" style="font-size: 10px;">underscore</a> <a href="/tags/underscore源码/" style="font-size: 10px;">underscore源码</a> <a href="/tags/vim/" style="font-size: 10px;">vim</a> <a href="/tags/vim命令/" style="font-size: 10px;">vim命令</a> <a href="/tags/webpack/" style="font-size: 16.67px;">webpack</a> <a href="/tags/webpack-4-0/" style="font-size: 15px;">webpack 4.0</a> <a href="/tags/webpack优化/" style="font-size: 10px;">webpack优化</a> <a href="/tags/webpack教程/" style="font-size: 15px;">webpack教程</a> <a href="/tags/依赖倒置原则/" style="font-size: 11.67px;">依赖倒置原则</a> <a href="/tags/全栈/" style="font-size: 10px;">全栈</a> <a href="/tags/前端/" style="font-size: 20px;">前端</a> <a href="/tags/前端学习/" style="font-size: 10px;">前端学习</a> <a href="/tags/前端工程师/" style="font-size: 10px;">前端工程师</a> <a href="/tags/前端常用网站/" style="font-size: 10px;">前端常用网站</a> <a href="/tags/前端打包工具/" style="font-size: 10px;">前端打包工具</a> <a href="/tags/前端设计模式/" style="font-size: 18.33px;">前端设计模式</a> <a href="/tags/单一职责原则/" style="font-size: 10px;">单一职责原则</a> <a href="/tags/原创/" style="font-size: 13.33px;">原创</a> <a href="/tags/图片加载/" style="font-size: 10px;">图片加载</a> <a href="/tags/图片加载完成事件/" style="font-size: 10px;">图片加载完成事件</a> <a href="/tags/开闭原则/" style="font-size: 10px;">开闭原则</a> <a href="/tags/微信小程序/" style="font-size: 10px;">微信小程序</a> <a href="/tags/技术发展/" style="font-size: 10px;">技术发展</a> <a href="/tags/接口隔离原则/" style="font-size: 10px;">接口隔离原则</a> <a href="/tags/正则/" style="font-size: 10px;">正则</a> <a href="/tags/源码/" style="font-size: 11.67px;">源码</a> <a href="/tags/滚动信息条间歇性滚动/" style="font-size: 10px;">滚动信息条间歇性滚动</a> <a href="/tags/理解https/" style="font-size: 10px;">理解https</a> <a href="/tags/迪米特法则/" style="font-size: 10px;">迪米特法则</a> <a href="/tags/里氏替换原则/" style="font-size: 10px;">里氏替换原则</a>
    			</div>
    	</section>
    

    
    	<section class="tools-section tools-section-friends">
  		
  			<div class="friends-wrap" id="js-friends">
  			
  	          <a target="_blank" class="main-nav-link switch-friends-link" href="https://github.com/Vera0707/huanhuashuixie/tree/master/framework">流行框架练习</a>
  	        
  	        </div>
  		
    	</section>
    

    
    	<section class="tools-section tools-section-me">
  	  	
  	  		<div class="aboutme-wrap" id="js-aboutme">一枚深水前端&lt;br/&gt;&lt;br/&gt;大神带带我&lt;br/&gt;小白我要升级打倒小怪兽</div>
  	  	
    	</section>
    
  </div>
  
</div>
    <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>
  </div>
  <link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">
  <script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script>
  <!--<script>-->
      <!--var WIDTH = window.innerWidth, HEIGHT = window.innerHeight, POINT = 35;-->

      <!--var canvas = document.getElementById('body-wrap');-->
      <!--canvas.width = WIDTH,-->
          <!--canvas.height = HEIGHT;-->
      <!--var context = canvas.getContext('2d');-->
      <!--context.strokeStyle = 'rgba(0,0,0,0.2)',-->
          <!--context.strokeWidth = 1,-->
          <!--context.fillStyle = 'rgba(0,0,0,0.1)';-->
      <!--var circleArr = [];-->

      <!--//线条：开始xy坐标，结束xy坐标，线条透明度-->
      <!--function Line (x, y, _x, _y, o) {-->
          <!--this.beginX = x,-->
              <!--this.beginY = y,-->
              <!--this.closeX = _x,-->
              <!--this.closeY = _y,-->
              <!--this.o = o;-->
      <!--}-->
      <!--//点：圆心xy坐标，半径，每帧移动xy的距离-->
      <!--function Circle (x, y, r, moveX, moveY) {-->
          <!--this.x = x,-->
              <!--this.y = y,-->
              <!--this.r = r,-->
              <!--this.moveX = moveX,-->
              <!--this.moveY = moveY;-->
      <!--}-->
      <!--//生成max和min之间的随机数-->
      <!--function num (max, _min) {-->
          <!--var min = arguments[1] || 0;-->
          <!--return Math.floor(Math.random()*(max-min+1)+min);-->
      <!--}-->
      <!--// 绘制原点-->
      <!--function drawCricle (cxt, x, y, r, moveX, moveY) {-->
          <!--var circle = new Circle(x, y, r, moveX, moveY)-->
          <!--cxt.beginPath()-->
          <!--cxt.arc(circle.x, circle.y, circle.r, 0, 2*Math.PI)-->
          <!--cxt.closePath()-->
          <!--cxt.fill();-->
          <!--return circle;-->
      <!--}-->
      <!--//绘制线条-->
      <!--function drawLine (cxt, x, y, _x, _y, o) {-->
          <!--var line = new Line(x, y, _x, _y, o)-->
          <!--cxt.beginPath()-->
          <!--cxt.strokeStyle = 'rgba(0,0,0,'+ o +')'-->
          <!--cxt.moveTo(line.beginX, line.beginY)-->
          <!--cxt.lineTo(line.closeX, line.closeY)-->
          <!--cxt.closePath()-->
          <!--cxt.stroke();-->

      <!--}-->
      <!--//每帧绘制-->
      <!--function draw () {-->
          <!--context.clearRect(0,0,canvas.width, canvas.height);-->
          <!--for (var i = 0; i < POINT; i++) {-->
              <!--drawCricle(context, circleArr[i].x, circleArr[i].y, circleArr[i].r);-->
          <!--}-->
          <!--for (var i = 0; i < POINT; i++) {-->
              <!--for (var j = 0; j < POINT; j++) {-->
                  <!--if (i + j < POINT) {-->
                      <!--var A = Math.abs(circleArr[i+j].x - circleArr[i].x),-->
                          <!--B = Math.abs(circleArr[i+j].y - circleArr[i].y);-->
                      <!--var lineLength = Math.sqrt(A*A + B*B);-->
                      <!--var C = 1/lineLength*7-0.009;-->
                      <!--var lineOpacity = C > 0.03 ? 0.03 : C;-->
                      <!--if (lineOpacity > 0) {-->
                          <!--drawLine(context, circleArr[i].x, circleArr[i].y, circleArr[i+j].x, circleArr[i+j].y, lineOpacity);-->
                      <!--}-->
                  <!--}-->
              <!--}-->
          <!--}-->
      <!--}-->
      <!--//初始化生成原点-->
      <!--function init () {-->
          <!--circleArr = [];-->
          <!--for (var i = 0; i < POINT; i++) {-->
              <!--circleArr.push(drawCricle(context, num(WIDTH), num(HEIGHT), num(15, 2), num(10, -10)/40, num(10, -10)/40));-->
          <!--}-->
          <!--draw();-->
      <!--}-->
      <!--//调用执行-->
      <!--window.onload = function () {-->
          <!--init();-->
          <!--setInterval(function () {-->
              <!--for (var i = 0; i < POINT; i++) {-->
                  <!--var cir = circleArr[i];-->
                  <!--cir.x += cir.moveX;-->
                  <!--cir.y += cir.moveY;-->
                  <!--if (cir.x > WIDTH) cir.x = 0;-->
                  <!--else if (cir.x < 0) cir.x = WIDTH;-->
                  <!--if (cir.y > HEIGHT) cir.y = 0;-->
                  <!--else if (cir.y < 0) cir.y = HEIGHT;-->
              <!--}-->
              <!--draw();-->
          <!--}, 10);-->
      <!--}-->
  <!--</script>-->
  <!--<script>-->
      <!--var gitment = new Gitment({-->
          <!--id: '', // 可选。默认为 location.href-->
          <!--owner: 'vera0707',-->
          <!--repo: 'https://github.com/vera0707/vera0707.github.io',-->
          <!--labels: "gitment-introduction",-->
          <!--oauth: {-->
              <!--client_id: '412dc716eeeb8fa2983f',-->
              <!--client_secret: 'e350354961bdca67937a21eed747e23ba1e6f86e'-->
          <!--}-->
      <!--})-->
      <!--gitment.render('remark')-->
  <!--</script>-->
</body>
</html>